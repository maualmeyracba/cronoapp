(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{54976:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(84297);let l=(0,s.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},22448:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(84297);let l=(0,s.Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},31012:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(84297);let l=(0,s.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},73696:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(84297);let l=(0,s.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},87764:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(84297);let l=(0,s.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},13718:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(84297);let l=(0,s.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},74429:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/servicios",function(){return a(61929)}])},43475:function(e,t,a){"use strict";a.d(t,{Z:function(){return DashboardLayout}});var s=a(85893),l=a(67294),r=a(41664),i=a.n(r),n=a(11163),o=a(41503),d=a(28477),c=a(85876),x=a(64712),u=a(54463),p=a(41352),h=a(39483),m=a(72367),g=a(34622),b=a(28909),f=a(81629),j=a(49525),v=a(71408),N=a(78051),k=a(77232);function DashboardLayout(e){let{children:t}=e,[a,r]=(0,l.useState)(!0),y=(0,n.useRouter)(),{user:w}=(0,o.a)(),handleLogout=async()=>{try{await (0,c.w7)(d.I8),window.location.href="/login"}catch(e){console.error("Error cerrando sesi\xf3n:",e)}},isActive=e=>y.pathname.startsWith(e),getLinkClass=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s="flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium text-sm ".concat(a?"":"justify-center px-2");return isActive(e)?"".concat(s," bg-indigo-600 text-white shadow-lg shadow-indigo-900/50"):t?"".concat(s," bg-rose-600/10 text-rose-400 hover:bg-rose-600 hover:text-white border border-rose-900/50 hover:border-rose-500"):"".concat(s," text-slate-300 hover:bg-slate-800 hover:text-white")};return(0,s.jsxs)("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 flex",children:[(0,s.jsx)(x.x7,{position:"top-right",richColors:!0,closeButton:!0,expand:!0}),(0,s.jsxs)("aside",{className:"fixed top-0 left-0 z-40 h-screen transition-all duration-300 bg-slate-900 text-white border-r border-slate-800 flex flex-col\n        ".concat(a?"w-64 translate-x-0":"w-20 -translate-x-full lg:translate-x-0"," \n        "),children:[(0,s.jsxs)("div",{className:"p-6 flex items-center ".concat(a?"justify-between":"justify-center"," shrink-0"),children:[a?(0,s.jsx)("span",{className:"text-xl font-black tracking-tighter text-indigo-400",children:"CRONOAPP"}):(0,s.jsx)(u.Z,{className:"text-indigo-400"}),(0,s.jsx)("button",{onClick:()=>r(!1),className:"lg:hidden text-slate-400 hover:text-white",children:(0,s.jsx)(p.Z,{})})]}),(0,s.jsxs)("nav",{className:"px-3 space-y-2 mt-4 flex-1 overflow-y-auto custom-scrollbar",children:[a&&(0,s.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Operativa"}),(0,s.jsxs)(i(),{href:"/admin/dashboard",className:getLinkClass("/admin/dashboard"),title:"Dashboard",children:[(0,s.jsx)(h.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Dashboard"})]}),(0,s.jsxs)(i(),{href:"/admin/operaciones",className:getLinkClass("/admin/operaciones",!0),title:"Centro Control",children:[(0,s.jsx)(m.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Centro Control"})]}),(0,s.jsxs)(i(),{href:"/admin/planificacion",className:getLinkClass("/admin/planificacion"),title:"Planificador",children:[(0,s.jsx)(g.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Planificador"})]}),a&&(0,s.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest mt-4",children:"Gesti\xf3n"}),(0,s.jsxs)(i(),{href:"/admin/crm",className:getLinkClass("/admin/crm"),title:"CRM Clientes",children:[(0,s.jsx)(b.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"CRM Clientes"})]}),(0,s.jsxs)(i(),{href:"/admin/servicios",className:getLinkClass("/admin/servicios"),title:"Servicios",children:[(0,s.jsx)(u.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Servicios"})]}),(0,s.jsxs)(i(),{href:"/admin/reportes",className:getLinkClass("/admin/reportes"),title:"Reportes",children:[(0,s.jsx)(f.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Reportes"})]}),(0,s.jsxs)(i(),{href:"/admin/rrhh",className:getLinkClass("/admin/rrhh"),title:"RRHH",children:[(0,s.jsx)(j.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"RRHH"})]}),a&&(0,s.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest mt-4",children:"Sistema"}),(0,s.jsxs)(i(),{href:"/admin/configuracion",className:getLinkClass("/admin/configuracion"),title:"Configuraci\xf3n",children:[(0,s.jsx)(v.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Configuraci\xf3n"})]})]}),(0,s.jsx)("div",{className:"p-4 border-t border-slate-800 shrink-0 flex flex-col gap-2",children:(0,s.jsxs)("button",{onClick:handleLogout,className:"w-full flex items-center justify-center gap-3 px-4 py-3 text-rose-400 hover:bg-rose-900/20 hover:text-rose-300 rounded-xl transition-all font-medium text-sm",title:"Cerrar Sesi\xf3n",children:[(0,s.jsx)(N.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Salir"})]})})]}),(0,s.jsxs)("div",{className:"flex-1 transition-all duration-300 ".concat(a?"lg:ml-64":"lg:ml-20"),children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 p-4 shadow-sm border-b border-slate-200 dark:border-slate-700 flex items-center gap-4 sticky top-0 z-30",children:[(0,s.jsx)("button",{onClick:()=>r(!a),className:"p-2 rounded-lg hover:bg-slate-100 text-slate-600 dark:text-slate-200 transition-colors",children:(0,s.jsx)(k.Z,{size:24})}),(0,s.jsx)("span",{className:"font-black text-slate-700 dark:text-white uppercase tracking-tight",children:a?"Panel de Control":"CronoApp"})]}),(0,s.jsx)("main",{className:"p-4 lg:p-8",children:t})]})]})}},41503:function(e,t,a){"use strict";a.d(t,{a:function(){return useAuth}}),a(85893);var s=a(67294);a(85876),a(28477),a(11163);let l=(0,s.createContext)({user:null,loading:!0,logout:async()=>{}}),useAuth=()=>(0,s.useContext)(l)},28477:function(e,t,a){"use strict";a.d(t,{I8:function(){return o},db:function(){return d},wk:function(){return c}});var s=a(83977),l=a(85876),r=a(93504),i=a(23914);let n=(0,s.C6)().length?(0,s.Mq)():(0,s.ZF)({apiKey:"AIzaSyBJaTiMekwbGPXAm-mkPl_u6KEWCSpvfic",authDomain:"comtroldata.firebaseapp.com",projectId:"comtroldata",storageBucket:"comtroldata.firebasestorage.app",messagingSenderId:"698108879063",appId:"1:698108879063:web:ab30eb8b80a774f52f1092"}),o=(0,l.v0)(n),d=(0,r.ad)(n),c=(0,i.$C)(n)},61929:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ServiciosSLAPage}});var s=a(85893),l=a(67294),r=a(43475),i=a(28477),n=a(93504);let o={getAll:async()=>{try{let e=(0,n.IO)((0,n.hJ)(i.db,"servicios_sla"),(0,n.Xo)("clientName")),t=await (0,n.PL)(e);return t.docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting services:",e),[]}},getByClientId:async e=>{try{let t=(0,n.IO)((0,n.hJ)(i.db,"servicios_sla"),(0,n.ar)("clientId","==",e)),a=await (0,n.PL)(t);return a.docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error filter services:",e),[]}},getClients:async()=>{try{let e=(0,n.IO)((0,n.hJ)(i.db,"clients"),(0,n.Xo)("name")),t=await (0,n.PL)(e);return t.docs.map(e=>{let t=e.data();return{id:e.id,name:t.name||t.fantasyName||"Sin Nombre",objectives:t.objetivos||t.objectives||[]}})}catch(e){return console.error("Error loading clients for dropdown:",e),[]}},add:async e=>(0,n.ET)((0,n.hJ)(i.db,"servicios_sla"),e),update:(e,t)=>(0,n.r7)((0,n.JU)(i.db,"servicios_sla",e),t),delete:e=>(0,n.oe)((0,n.JU)(i.db,"servicios_sla",e))};var d=a(92243),c=a(85876),x=a(31012),u=a(87764),p=a(54976),h=a(22448),m=a(13718),g=a(84297);let b=(0,g.Z)("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);var f=a(28909),j=a(41352),v=a(73696),N=a(71408),k=a(56989);let y={M:{code:"M",name:"Ma\xf1ana",startTime:"07:00",endTime:"15:00",hours:8},T:{code:"T",name:"Tarde",startTime:"15:00",endTime:"23:00",hours:8},N:{code:"N",name:"Noche",startTime:"23:00",endTime:"07:00",hours:8},D12:{code:"D12",name:"Diurno 12h",startTime:"07:00",endTime:"19:00",hours:12},N12:{code:"N12",name:"Nocturno 12h",startTime:"19:00",endTime:"07:00",hours:12}};function ServiciosSLAPage(){let{addToast:e}=(0,d.p)(),[t,a]=(0,l.useState)("Cargando..."),[g,w]=(0,l.useState)("list"),[C,S]=(0,l.useState)([]),[T,D]=(0,l.useState)([]),[Z,E]=(0,l.useState)([]),[M,I]=(0,l.useState)([]),[A,L]=(0,l.useState)(""),P=new Date,O=new Date(P.getFullYear(),P.getMonth(),1).toISOString().split("T")[0],z=new Date(P.getFullYear(),P.getMonth()+1,0).toISOString().split("T")[0],[_,R]=(0,l.useState)({clientId:"",clientName:"",objectiveId:"",objectiveName:"",startDate:O,endDate:z,positions:[],totalMonthlyHours:0,status:"active"}),[F,V]=(0,l.useState)(!1),[H,q]=(0,l.useState)({id:"",name:"Puesto 1",coverageType:"24hs",quantity:1,activeDays:["L","M","X","J","V","S","D"],allowedShiftTypes:[]}),[U,J]=(0,l.useState)({name:"",start:"20:00",end:"05:00",code:"",days:["V","S"]}),[B,X]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=(0,c.v0)(),t=(0,c.Aj)(e,e=>{e?a(e.displayName||e.email||"Usuario Sin Nombre"):a("No Logueado")});return()=>t()},[]),(0,l.useEffect)(()=>{loadData(),loadClients()},[]),(0,l.useEffect)(()=>{let e=A.toLowerCase().trim();if(!e){I(C);return}let t=C.filter(t=>{let a=(t.clientName||"").toLowerCase(),s=(t.objectiveName||"").toLowerCase();return a.includes(e)||s.includes(e)});I(t)},[A,C]);let loadData=async()=>{let e=await o.getAll(),t=e.map(e=>({...e,positions:e.positions||[]}));S(t)},loadClients=async()=>{let e=await o.getClients();D(e)},registrarAuditoria=async(e,t)=>{try{let a=(0,c.v0)(),s=a.currentUser,l=(null==s?void 0:s.displayName)||(null==s?void 0:s.email)||"Usuario Desconocido",r=(null==s?void 0:s.uid)||"SYSTEM";await (0,n.ET)((0,n.hJ)(i.db,"audit_logs"),{timestamp:(0,n.Bt)(),actorUid:r,actorName:l,action:e,module:"SERVICIOS",details:t,metadata:{platform:"web"}})}catch(e){console.error("Error auditor\xeda:",e)}},calculateShiftHours=(e,t)=>{let[a,s]=e.split(":").map(Number),[l,r]=t.split(":").map(Number),i=l-a+(r-s)/60;return i<0&&(i+=24),parseFloat(i.toFixed(2))},calculateMonthlyBreakdown=(e,t,a)=>{if(!t||!a||0===e.length)return[];let s=t.split("-").map(Number),l=a.split("-").map(Number),r=new Date(s[0],s[1]-1,s[2]),i=new Date(l[0],l[1]-1,l[2]),n=["D","L","M","X","J","V","S"],o={};for(;r<=i;){let t=r.getFullYear(),a=r.getMonth(),s="".concat(t,"-").concat(a),l=r.toLocaleString("es-ES",{month:"long",year:"numeric"}),i=n[r.getDay()];o[s]||(o[s]={name:l.charAt(0).toUpperCase()+l.slice(1),days:0,hours:0}),o[s].days++;let d=0;e.forEach(e=>{let t=0;"24hs"===e.coverageType?t=24:"12hs_diurno"===e.coverageType?t=12:"12hs_nocturno"===e.coverageType?t=12:"custom"===e.coverageType&&e.allowedShiftTypes.forEach(e=>{e.days&&e.days.length>0?e.days.includes(i)&&(t+=e.hours):t+=e.hours}),d+=t*e.quantity}),o[s].hours+=d,r.setDate(r.getDate()+1)}return Object.values(o)},Y=calculateMonthlyBreakdown(_.positions,_.startDate,_.endDate),G=Math.round(Y.reduce((e,t)=>e+t.hours,0)),updateVariantsForCoverage=(e,t)=>{let a=[];"24hs"===e?a=[y.M,y.T,y.N,y.D12,y.N12]:"12hs_diurno"===e?a=[y.M,y.D12]:"12hs_nocturno"===e&&(a=[y.N,y.N12]),q({...t,allowedShiftTypes:"custom"===e?[]:a,coverageType:e})},toggleStandardVariant=e=>{let t=y[e],a=H.allowedShiftTypes.find(e=>e.code===t.code&&!e.isCustom),s=[...H.allowedShiftTypes];a?s=s.filter(e=>e.code!==t.code||e.isCustom):s.push(t),q({...H,allowedShiftTypes:s})},toggleNewShiftDay=e=>{J(t=>{let a=t.days.includes(e)?t.days.filter(t=>t!==e):[...t.days,e];return{...t,days:a}})},removeCustomVariant=e=>{q(t=>({...t,allowedShiftTypes:t.allowedShiftTypes.filter(t=>t.code!==e)}))},removePosition=e=>{let t=_.positions.filter(t=>t.id!==e);R({..._,positions:t})},handleSave=async()=>{if(!_.clientId)return e("Falta Cliente","error");let t={..._};try{B&&_.id?(await o.update(_.id,t),await registrarAuditoria("UPDATE_CONTRACT","Edit\xf3 contrato: ".concat(_.clientName," - ").concat(_.objectiveName))):(await o.add(t),await registrarAuditoria("CREATE_CONTRACT","Cre\xf3 contrato: ".concat(_.clientName," - ").concat(_.objectiveName))),e("Guardado correctamente","success"),loadData(),w("list")}catch(t){e("Error al guardar","error"),console.error(t)}},handleEdit=e=>{R(e);let t=T.find(t=>t.id===e.clientId);t&&E(t.objectives||[]),X(!0),w("form")},handleDelete=async e=>{let t=C.find(t=>t.id===e);confirm("\xbfBorrar contrato?")&&(await o.delete(e),await registrarAuditoria("DELETE_CONTRACT","Elimin\xf3 contrato: ".concat(null==t?void 0:t.clientName," - ").concat(null==t?void 0:t.objectiveName)),loadData())};return(0,s.jsx)(r.Z,{children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6 animate-in fade-in",children:[(0,s.jsxs)("header",{className:"flex justify-between items-end",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-black text-slate-900 dark:text-white uppercase",children:"Servicios & SLA"}),(0,s.jsxs)("p",{className:"text-[10px] text-indigo-500 mt-1",children:["Usuario Activo: ",(0,s.jsx)("b",{children:t})]})]}),"list"===g&&(0,s.jsxs)("button",{onClick:()=>{let e=new Date;R({clientId:"",clientName:"",objectiveId:"",objectiveName:"",startDate:new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0],endDate:new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0],positions:[],totalMonthlyHours:0,status:"active"}),X(!1),w("form")},className:"bg-indigo-600 text-white px-6 py-3 rounded-xl font-black text-xs uppercase shadow-xl flex gap-2",children:[(0,s.jsx)(x.Z,{size:16})," Nuevo Contrato"]})]}),"list"===g&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-2xl border dark:border-slate-700 flex items-center gap-4 shadow-sm",children:[(0,s.jsx)(u.Z,{className:"text-slate-400"}),(0,s.jsx)("input",{placeholder:"Buscar...",className:"w-full bg-transparent outline-none font-bold text-slate-700 dark:text-white uppercase",value:A,onChange:e=>L(e.target.value)})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(e=>{let t=Math.round(calculateMonthlyBreakdown(e.positions,e.startDate,e.endDate).reduce((e,t)=>e+t.hours,0));return(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-[2.5rem] border dark:border-slate-700 shadow-sm hover:shadow-lg transition-all group relative overflow-hidden flex flex-col h-full",children:[(0,s.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-2 ".concat("active"===e.status?"bg-emerald-500":"bg-slate-300")}),(0,s.jsxs)("div",{className:"pl-4 flex-1",children:[(0,s.jsx)("h3",{className:"font-black text-lg text-slate-800 dark:text-white uppercase truncate",children:e.clientName}),(0,s.jsxs)("p",{className:"text-sm font-bold text-indigo-500 mt-1 uppercase mb-4 flex items-center gap-1",children:[(0,s.jsx)(p.Z,{size:12})," ",e.objectiveName]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("p",{className:"text-[9px] font-black uppercase text-slate-400 mb-2",children:"Estructura"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.positions.length>0?e.positions.map((e,t)=>(0,s.jsxs)("span",{className:"text-[9px] font-bold bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 px-2 py-1 rounded-md uppercase border border-indigo-100 dark:border-indigo-800",children:[e.quantity,"x ",e.name]},t)):(0,s.jsx)("span",{className:"text-[9px] text-slate-400",children:"Sin definir"})})]}),(0,s.jsx)("div",{className:"mb-4 pt-4 border-t dark:border-slate-700",children:(0,s.jsxs)("div",{className:"flex justify-between items-end mb-2",children:[(0,s.jsx)("span",{className:"text-[10px] font-black uppercase text-slate-400",children:"Total Periodo"}),(0,s.jsxs)("span",{className:"text-2xl font-black text-indigo-600 dark:text-indigo-400",children:[t," ",(0,s.jsx)("span",{className:"text-xs",children:"hs"})]})]})})]}),(0,s.jsxs)("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>handleEdit(e),className:"p-2 bg-white dark:bg-slate-700 rounded-lg shadow text-indigo-600",children:(0,s.jsx)(h.Z,{size:14})}),(0,s.jsx)("button",{onClick:()=>handleDelete(e.id),className:"p-2 bg-white dark:bg-slate-700 rounded-lg shadow text-rose-600",children:(0,s.jsx)(m.Z,{size:14})})]})]},e.id)})})]}),"form"===g&&(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-[3rem] border dark:border-slate-700 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-black text-slate-900 dark:text-white uppercase",children:[B?"Editar":"Nuevo"," Contrato"]}),(0,s.jsx)("p",{className:"text-slate-400 text-xs mt-1",children:"Configure los puestos y la cobertura."})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"text-4xl font-black text-indigo-600 dark:text-indigo-400",children:[G," ",(0,s.jsx)("span",{className:"text-sm text-indigo-300 font-bold",children:"hs"})]}),(0,s.jsx)("div",{className:"text-[10px] font-black uppercase text-slate-400 mt-1",children:"Total Presupuestado (C\xe1lculo Diario)"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-1",children:"Cliente"}),(0,s.jsxs)("select",{className:"w-full p-4 bg-slate-50 dark:bg-slate-900 border dark:border-slate-600 rounded-2xl font-bold text-sm dark:text-white",value:_.clientId,onChange:e=>{let t=e.target.value,a=T.find(e=>e.id===t);a&&(R(e=>({...e,clientId:a.id,clientName:a.name,objectiveId:"",objectiveName:""})),E(a.objectives||[]))},children:[(0,s.jsx)("option",{value:"",children:"Seleccionar..."}),T.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-1",children:"Objetivo"}),(0,s.jsxs)("select",{className:"w-full p-4 bg-slate-50 dark:bg-slate-900 border dark:border-slate-600 rounded-2xl font-bold text-sm dark:text-white",value:_.objectiveId,onChange:e=>{let t=e.target.value,a=Z.find(e=>e.id===t);a&&R(e=>({...e,objectiveId:a.id,objectiveName:a.name}))},disabled:!_.clientId,children:[(0,s.jsx)("option",{value:"",children:"Seleccionar..."}),Z.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-1",children:"Inicio"}),(0,s.jsx)("input",{type:"date",className:"w-full p-4 bg-slate-50 dark:bg-slate-900 border dark:border-slate-600 rounded-2xl font-bold text-xs dark:text-white",value:_.startDate,onChange:e=>R({..._,startDate:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-1",children:"Fin"}),(0,s.jsx)("input",{type:"date",className:"w-full p-4 bg-slate-50 dark:bg-slate-900 border dark:border-slate-600 rounded-2xl font-bold text-xs dark:text-white",value:_.endDate,onChange:e=>R({..._,endDate:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-4 rounded-2xl border dark:border-slate-700/50",children:[(0,s.jsxs)("h4",{className:"text-[10px] font-black uppercase text-slate-400 mb-3 flex items-center gap-2",children:[(0,s.jsx)(b,{size:12})," Facturaci\xf3n Estimada"]}),(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-1",children:Y.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between items-center bg-white dark:bg-slate-800 p-2 rounded-xl border dark:border-slate-700",children:[(0,s.jsx)("span",{className:"text-[10px] font-bold text-slate-600 dark:text-slate-300 uppercase",children:e.name}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("span",{className:"block text-xs font-black text-indigo-600 dark:text-indigo-400",children:[Math.round(e.hours)," hs"]}),(0,s.jsxs)("span",{className:"block text-[8px] text-slate-400 font-bold",children:[e.days," d\xedas"]})]})]},t))})]})]}),(0,s.jsxs)("div",{className:"lg:col-span-2 bg-slate-50 dark:bg-slate-900/30 p-6 rounded-[2.5rem] border dark:border-slate-700/50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("h3",{className:"text-sm font-black uppercase text-slate-700 dark:text-white flex items-center gap-2",children:[(0,s.jsx)(f.Z,{size:18,className:"text-indigo-500"})," Estructura Operativa"]}),(0,s.jsxs)("button",{onClick:()=>{q({id:"",name:"Puesto 1",coverageType:"24hs",quantity:1,activeDays:["L","M","X","J","V","S","D"],allowedShiftTypes:[]}),updateVariantsForCoverage("24hs",{...H,coverageType:"24hs"}),J({name:"",start:"20:00",end:"05:00",code:"",days:["V","S"]}),V(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-xl text-[10px] font-black uppercase hover:scale-105 transition-transform flex items-center gap-2",children:[(0,s.jsx)(x.Z,{size:14})," Agregar Puesto"]})]}),(0,s.jsx)("div",{className:"space-y-3",children:_.positions.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-2xl border dark:border-slate-700 shadow-sm flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 text-left",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h4",{className:"font-bold text-slate-800 dark:text-white text-sm uppercase",children:e.name}),(0,s.jsxs)("span",{className:"bg-emerald-100 dark:bg-emerald-900 text-emerald-600 dark:text-emerald-300 px-2 py-0.5 rounded text-[9px] font-black uppercase",children:[e.quantity," PAX"]})]}),(0,s.jsx)("div",{className:"mt-1 flex items-center gap-2",children:(0,s.jsx)("span",{className:"text-[10px] font-bold text-indigo-500 bg-indigo-50 dark:bg-indigo-900/50 px-2 rounded",children:"24hs"===e.coverageType?"24 HS":e.coverageType.toUpperCase()})})]}),(0,s.jsx)("div",{className:"flex gap-1 flex-wrap justify-end max-w-xs",children:e.allowedShiftTypes.map(e=>(0,s.jsxs)("div",{className:"text-center bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded-lg border dark:border-slate-600",children:[(0,s.jsx)("div",{className:"text-[9px] font-black text-slate-600 dark:text-slate-300",children:e.code}),(0,s.jsxs)("div",{className:"text-[7px] text-slate-400",children:[e.hours,"h"]})]},e.code))}),(0,s.jsx)("button",{onClick:()=>removePosition(e.id),className:"p-2 bg-slate-100 dark:bg-slate-700 rounded-lg text-rose-500 hover:bg-rose-100",children:(0,s.jsx)(j.Z,{size:14})})]},e.id))})]})]}),(0,s.jsxs)("div",{className:"mt-8 flex justify-end gap-4 border-t dark:border-slate-700 pt-6",children:[(0,s.jsx)("button",{onClick:()=>w("list"),className:"text-slate-400 font-bold uppercase text-xs",children:"Cancelar"}),(0,s.jsxs)("button",{onClick:handleSave,className:"bg-slate-900 dark:bg-white dark:text-slate-900 text-white px-8 py-3 rounded-xl font-black uppercase text-xs shadow-xl",children:[(0,s.jsx)(v.Z,{size:16,className:"mr-2 inline"})," Guardar"]})]})]}),F&&(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/80 z-[100] flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 w-full max-w-lg p-8 rounded-[3rem] animate-in zoom-in-95 shadow-2xl border dark:border-slate-600",children:[(0,s.jsxs)("h3",{className:"text-xl font-black text-slate-900 dark:text-white uppercase mb-6 flex items-center gap-2",children:[(0,s.jsx)(N.Z,{className:"text-indigo-500"})," Definir Puesto"]}),(0,s.jsxs)("div",{className:"space-y-5",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-1",children:"Nombre"}),(0,s.jsx)("input",{className:"w-full p-3 bg-slate-50 dark:bg-slate-900 border dark:border-slate-600 rounded-xl font-bold dark:text-white",value:H.name,onChange:e=>q({...H,name:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-1",children:"Pax"}),(0,s.jsx)("input",{type:"number",min:"1",className:"w-full p-3 bg-slate-50 dark:bg-slate-900 border dark:border-slate-600 rounded-xl font-bold text-center dark:text-white",value:H.quantity,onChange:e=>q({...H,quantity:parseInt(e.target.value)||1})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-1",children:"Tipo de Cobertura"}),(0,s.jsxs)("select",{className:"w-full p-3 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-xl font-bold text-indigo-700 dark:text-indigo-300",value:H.coverageType,onChange:e=>{let t=e.target.value;updateVariantsForCoverage(t,H)},children:[(0,s.jsx)("option",{value:"24hs",children:"24 HORAS (Lunes a Lunes)"}),(0,s.jsx)("option",{value:"12hs_diurno",children:"12 HORAS DIURNO"}),(0,s.jsx)("option",{value:"12hs_nocturno",children:"12 HORAS NOCTURNO"}),(0,s.jsx)("option",{value:"custom",children:"PERSONALIZADO / TURNOS ESPEC\xcdFICOS"})]})]}),"custom"===H.coverageType&&(0,s.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-2xl border border-orange-100 dark:border-orange-800",children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center mb-4 text-orange-700 dark:text-orange-400 bg-orange-100 dark:bg-orange-900/40 p-2 rounded-lg",children:[(0,s.jsx)(k.Z,{size:14}),(0,s.jsx)("p",{className:"text-[9px] font-bold",children:"El c\xe1lculo de horas es autom\xe1tico seg\xfan los d\xedas asignados."})]}),(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 mb-2 block",children:"1. Turnos Est\xe1ndar (Todos los d\xedas)"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:Object.keys(y).map(e=>{let t=y[e],a=H.allowedShiftTypes.some(e=>e.code===t.code&&!e.isCustom);return(0,s.jsxs)("button",{onClick:()=>toggleStandardVariant(e),className:"px-3 py-1 rounded-lg border text-[10px] font-bold ".concat(a?"bg-orange-100 border-orange-300 text-orange-700":"bg-white text-slate-500"),children:[t.name," (",t.hours,"h)"]},e)})}),(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 mb-2 block",children:"2. Crear Turno a Medida"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("span",{className:"text-[9px] text-slate-400",children:"Nombre"}),(0,s.jsx)("input",{className:"w-full p-2 text-xs font-bold rounded-lg border",placeholder:"Ej: Puerta Bar",value:U.name,onChange:e=>J({...U,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"w-20",children:[(0,s.jsx)("span",{className:"text-[9px] text-slate-400",children:"Inicio"}),(0,s.jsx)("input",{type:"time",className:"w-full p-2 text-xs font-bold rounded-lg border text-center",value:U.start,onChange:e=>J({...U,start:e.target.value})})]}),(0,s.jsxs)("div",{className:"w-20",children:[(0,s.jsx)("span",{className:"text-[9px] text-slate-400",children:"Fin"}),(0,s.jsx)("input",{type:"time",className:"w-full p-2 text-xs font-bold rounded-lg border text-center",value:U.end,onChange:e=>J({...U,end:e.target.value})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[9px] text-slate-400 block mb-1",children:"D\xedas Habilitados"}),(0,s.jsxs)("div",{className:"flex gap-1 justify-between items-center",children:[(0,s.jsx)("div",{className:"flex gap-1",children:["L","M","X","J","V","S","D"].map(e=>(0,s.jsx)("button",{onClick:()=>toggleNewShiftDay(e),className:"w-7 h-7 rounded text-[9px] font-black transition-colors ".concat(U.days.includes(e)?"bg-slate-900 text-white":"bg-white border text-slate-400"),children:e},e))}),(0,s.jsxs)("button",{onClick:()=>{if(!U.name)return;let e=calculateShiftHours(U.start,U.end),t=U.code||U.name.substring(0,2).toUpperCase(),a={code:t,name:U.name,startTime:U.start,endTime:U.end,hours:e,isCustom:!0,days:U.days};q(e=>({...e,allowedShiftTypes:[...e.allowedShiftTypes,a]})),J(e=>({...e,name:"",code:""}))},className:"bg-slate-900 text-white px-4 py-1.5 rounded-lg font-bold text-xs hover:scale-105 flex items-center gap-1",children:[(0,s.jsx)(x.Z,{size:14})," Agregar"]})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-4 rounded-2xl border dark:border-slate-700",children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 mb-2 block",children:"Turnos Habilitados"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:H.allowedShiftTypes.length>0?H.allowedShiftTypes.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-white dark:bg-slate-800 px-3 py-2 rounded-lg border dark:border-slate-600 shadow-sm relative group",children:[(0,s.jsx)("span",{className:"w-6 h-6 flex items-center justify-center rounded text-[10px] font-black ".concat(e.isCustom?"bg-orange-100 text-orange-600":"bg-indigo-100 text-indigo-600"),children:e.code}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-[9px] font-bold text-slate-700 dark:text-white uppercase leading-none",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)("p",{className:"text-[8px] text-slate-400",children:[e.startTime,"-",e.endTime," (",e.hours,"h)"]}),e.days&&(0,s.jsx)("p",{className:"text-[8px] font-black text-slate-500 bg-slate-100 px-1 rounded",children:e.days.join("")})]})]}),"custom"===H.coverageType&&(0,s.jsx)("button",{onClick:()=>removeCustomVariant(e.code),className:"absolute -top-1 -right-1 bg-rose-500 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100",children:(0,s.jsx)(j.Z,{size:10})})]},e.code)):(0,s.jsx)("span",{className:"text-xs text-slate-400 italic",children:"Ning\xfan turno seleccionado."})})]}),(0,s.jsxs)("div",{className:"pt-4 flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>V(!1),className:"flex-1 py-3 bg-slate-100 dark:bg-slate-700 text-slate-500 font-bold rounded-xl uppercase text-xs",children:"Cancelar"}),(0,s.jsx)("button",{onClick:()=>{if(!H.name)return e("Nombre requerido","error");if(0===H.allowedShiftTypes.length)return e("Seleccione al menos un turno","error");let t={...H,id:H.id||Date.now().toString()},a=[..._.positions];H.id?a=a.map(e=>e.id===H.id?t:e):a.push(t),R({..._,positions:a}),V(!1)},className:"flex-1 py-3 bg-indigo-600 text-white font-black rounded-xl uppercase text-xs shadow-lg",children:"Confirmar"})]})]})]})})]})})}}},function(e){e.O(0,[761,897,963,712,354,774,888,179],function(){return e(e.s=74429)}),_N_E=e.O()}]);