(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[482],{70979:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("AlertOctagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},51853:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},13766:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},45977:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},54976:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},25169:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]])},31012:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},73696:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},19931:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("Siren",[["path",{d:"M7 12a5 5 0 0 1 5-5v0a5 5 0 0 1 5 5v6H7v-6Z",key:"rmc51c"}],["path",{d:"M5 20a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v2H5v-2Z",key:"yyvmjy"}],["path",{d:"M21 12h1",key:"jtio3y"}],["path",{d:"M18.5 4.5 18 5",key:"g5sp9y"}],["path",{d:"M2 12h1",key:"1uaihz"}],["path",{d:"M12 2v1",key:"11qlp1"}],["path",{d:"m4.929 4.929.707.707",key:"1i51kw"}],["path",{d:"M12 12v6",key:"3ahymv"}]])},41830:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]])},87966:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(84297);let r=(0,s.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},75646:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/planificacion",function(){return a(4851)}])},4851:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return PlanificacionPage}});var s=a(85893),r=a(67294),l=a(9008),n=a.n(l),o=a(43475),i=a(49525),d=a(84297);let c=(0,d.Z)("ArrowRightCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}]]);var x=a(94336),m=a(41352),p=a(19931);let u=(0,d.Z)("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);var h=a(41830),b=a(73696),f=a(76789),g=a(33683),v=a(98814),j=a(64998);let y=(0,d.Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),N=(0,d.Z)("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]),w=(0,d.Z)("ArrowDownAZ",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]]);var k=a(34464),S=a(11607),A=a(57349),C=a(13766),D=a(13718);let F=(0,d.Z)("BadgePercent",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 15h.01",key:"lqbp3k"}]]),E=(0,d.Z)("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);var I=a(45977),T=a(54976),M=a(87966);let O=(0,d.Z)("CalendarSearch",[["path",{d:"M21 12V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h7.5",key:"18ncp8"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M18 21a3 3 0 1 0 0-6 3 3 0 0 0 0 6v0Z",key:"mgbru4"}],["path",{d:"m22 22-1.5-1.5",key:"1x83k4"}]]);var z=a(45077),Z=a(70979);let L=(0,d.Z)("FastForward",[["polygon",{points:"13 19 22 12 13 5 13 19",key:"587y9g"}],["polygon",{points:"2 19 11 12 2 5 2 19",key:"3pweh0"}]]),R=(0,d.Z)("Rewind",[["polygon",{points:"11 19 2 12 11 5 11 19",key:"14yba5"}],["polygon",{points:"22 19 13 12 22 5 22 19",key:"1pi1cj"}]]);var _=a(25169),U=a(14199),V=a(51853);let P=(0,d.Z)("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);var H=a(13756),B=a(87764),J=a(31012),K=a(28477),W=a(85876),G=a(93504),q=a(64712);let Y={M:"bg-blue-100 text-blue-700 border-blue-200",T:"bg-orange-100 text-orange-700 border-orange-200",N:"bg-indigo-100 text-indigo-700 border-indigo-200",D12:"bg-cyan-100 text-cyan-700 border-cyan-200",N12:"bg-purple-100 text-purple-700 border-purple-200",F:"bg-emerald-100 text-emerald-700 border-emerald-200",PU:"bg-pink-100 text-pink-700 border-pink-200",A:"bg-red-100 text-red-700 border-red-300 font-black pattern-diagonal",V:"bg-teal-600 text-white border-teal-700 font-black shadow-sm",L:"bg-purple-100 text-purple-700 border-purple-300 font-black",E:"bg-rose-100 text-rose-700 border-rose-300 font-black","Ausencia con Aviso":"bg-amber-100 text-amber-700 border-amber-300",LOCKED:"bg-slate-200 text-slate-500 border-slate-300 pattern-grid",PAST:"bg-gray-100 text-gray-300 border-gray-200 cursor-not-allowed",CONSOLIDATED:"bg-slate-100 text-slate-600 border-slate-300 font-bold opacity-90",FT:"bg-violet-600 text-white border-violet-700 font-black shadow-sm",FF:"bg-cyan-600 text-white border-cyan-700 font-black shadow-sm",SWAP:"bg-cyan-50 text-cyan-700 border-cyan-300 border-dashed font-bold"},X={weekly:48,monthly:200},Q={M:8,T:8,N:8,D12:12,N12:12,PU:12,F:0,FF:0,V:0,L:0,A:0,E:0},getDateKey=e=>{var t,a,s;let r=e.toDate?e.toDate():new Date(e),l=new Intl.DateTimeFormat("es-AR",{timeZone:"America/Argentina/Cordoba",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(r),n=null===(t=l.find(e=>"day"===e.type))||void 0===t?void 0:t.value,o=null===(a=l.find(e=>"month"===e.type))||void 0===a?void 0:a.value,i=null===(s=l.find(e=>"year"===e.type))||void 0===s?void 0:s.value;return"".concat(i,"-").concat(o,"-").concat(n)},isDateLocked=e=>{let[t,a,s]=e.split("-").map(Number),r=new Date(t,a-1,s);r.setHours(23,59,59,999);let l=new Date;return l.setHours(0,0,0,0),r<l},getDefaultStyle=e=>Y[e]||"bg-slate-100 text-slate-700 border-slate-300",formatTime=e=>{if(!e)return"--:--";let t=e.toDate?e.toDate():new Date(e);return t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})},$={ASIGNACION:"Asignaci\xf3n",ELIMINACION:"Eliminaci\xf3n",EDICION_MASIVA:"Edici\xf3n Masiva",ASIGNACION_MASIVA:"Asignaci\xf3n M\xfaltiple",CAMBIO_FRANCO_TURNO:"Franco x Turno (FT)",CAMBIO_TURNO_FRANCO:"Turno x Franco (FF)"},isShiftConsolidated=e=>!!e&&("PRESENT"===e.status||"CHECK_IN"===e.status||"COMPLETED"===e.status);function PlanificacionPage(){var e,t,a,l,d,ee,et,ea,es,er,el,en;let[eo,ei]=(0,r.useState)(new Date),[ed,ec]=(0,r.useState)(""),[ex,em]=(0,r.useState)(""),[ep,eu]=(0,r.useState)(!1),[eh,eb]=(0,r.useState)(!1),[ef,eg]=(0,r.useState)("activity"),[ev,ej]=(0,r.useState)([]),[ey,eN]=(0,r.useState)({}),[ew,ek]=(0,r.useState)({}),[eS,eA]=(0,r.useState)([]),[eC,eD]=(0,r.useState)([]),[eF,eE]=(0,r.useState)([]),[eI,eT]=(0,r.useState)([]),[eM,eO]=(0,r.useState)(!1),[ez,eZ]=(0,r.useState)(!1),[eL,eR]=(0,r.useState)("Cargando..."),[e_,eU]=(0,r.useState)(""),[eV,eP]=(0,r.useState)({}),[eH,eB]=(0,r.useState)([]),[eJ,eK]=(0,r.useState)(!1),[eW,eG]=(0,r.useState)(""),[eq,eY]=(0,r.useState)(""),[eX,eQ]=(0,r.useState)(null),[e$,e0]=(0,r.useState)(null),[e1,e2]=(0,r.useState)(""),[e4,e5]=(0,r.useState)({}),[e3,e6]=(0,r.useState)({start:null,end:null}),[e7,e8]=(0,r.useState)(!1),[e9,te]=(0,r.useState)(!1),[tt,ta]=(0,r.useState)([]),[ts,tr]=(0,r.useState)(null),[tl,tn]=(0,r.useState)("NONE"),[to,ti]=(0,r.useState)(!1),[td,tc]=(0,r.useState)(null),[tx,tm]=(0,r.useState)(""),[tp,tu]=(0,r.useState)(""),[th,tb]=(0,r.useState)(""),[tf,tg]=(0,r.useState)([]),[tv,tj]=(0,r.useState)(!1),[ty,tN]=(0,r.useState)("M"),[tw,tk]=(0,r.useState)("M"),[tS,tA]=(0,r.useState)(!1),[tC,tD]=(0,r.useState)(!1),[tF,tE]=(0,r.useState)(!1),[tI,tT]=(0,r.useState)({type:"Ausencia con Aviso",reason:""}),[tM,tO]=(0,r.useState)(!1),[tz,tZ]=(0,r.useState)(null),[tL,tR]=(0,r.useState)(!1),[t_,tU]=(0,r.useState)(null),[tV,tP]=(0,r.useState)(""),[tH,tB]=(0,r.useState)({extend:!1,early:!1,plannedNovedad:""});(0,r.useEffect)(()=>{let loadUsers=async()=>{try{let e=await (0,G.PL)((0,G.hJ)(K.db,"system_users")),t={};e.docs.forEach(e=>{let a=e.data();a.email&&(t[a.email]=a.name||a.email)}),eP(t)}catch(e){console.error("Error loading users",e)}};loadUsers();let e=(0,W.v0)();(0,W.Aj)(e,e=>{e?(eU(e.email||""),eR(e.displayName||e.email||"Usuario")):eR("No Logueado")})},[]),(0,r.useEffect)(()=>{let e=(0,G.cf)((0,G.hJ)(K.db,"clients"),e=>eA(e.docs.map(e=>({id:e.id,...e.data()})))),t=(0,G.cf)((0,G.hJ)(K.db,"convenios"),e=>eD(e.docs.map(e=>({id:e.id,...e.data()})))),a=(0,G.cf)((0,G.hJ)(K.db,"empleados"),e=>ej(e.docs.map(e=>({id:e.id,name:e.data().name||e.data().firstName+" "+e.data().lastName,preferredObjectiveId:e.data().preferredObjectiveId,laborAgreement:e.data().laborAgreement})))),s=(0,G.cf)((0,G.hJ)(K.db,"turnos"),e=>{let t={};e.docs.forEach(e=>{var a;let s=e.data();if(null===(a=s.startTime)||void 0===a?void 0:a.seconds){let a=getDateKey(s.startTime),r="".concat(s.employeeId,"_").concat(a);t[r]={id:e.id,...s,code:s.code||s.type,objectiveId:s.objectiveId,startTime:s.startTime,realStartTime:s.realStartTime,status:s.status,isExtended:s.isExtended,isEarlyStart:s.isEarlyStart||s.isEarlyEntry,isFrancoTrabajado:s.isFrancoTrabajado||!1,isFrancoCompensatorio:s.isFrancoCompensatorio||!1,swapWith:s.swapWith,swapDate:s.swapDate,hasNovedad:s.hasNovedad,plannedNovedad:s.plannedNovedad}}}),eN(t)}),r=(0,G.cf)((0,G.hJ)(K.db,"ausencias"),e=>{let t={};e.docs.forEach(e=>{let a=e.data();if(a.startDate&&a.endDate&&a.employeeId){let[s,r,l]=a.startDate.split("-").map(Number),[n,o,i]=a.endDate.split("-").map(Number),d=new Date(s,r-1,l),c=new Date(n,o-1,i);for(;d<=c;){let s="".concat(a.employeeId,"_").concat(getDateKey(d));t[s]={id:e.id,...a,isAbsence:!0},d.setDate(d.getDate()+1)}}}),ek(t)});return()=>{e(),a(),s(),r(),t()}},[]);let handleNotificationClick=async e=>{if(eO(!1),"AUSENCIA"===e.source&&e.type&&(e.type.includes("Vacaciones")||e.type.includes("Licencia"))){tU(e),tP(""),tR(!0);return}if(e.date)try{var t;let a=null;if("string"==typeof e.date){let t=e.date.split("-");if(3===t.length){let e=parseInt(t[0]),s=parseInt(t[1])-1,r=parseInt(t[2]);a=new Date(e,s,r)}}else e.date instanceof Date?a=e.date:(null===(t=e.date)||void 0===t?void 0:t.seconds)&&(a=new Date(1e3*e.date.seconds));if(a){ei(new Date(a.getFullYear(),a.getMonth(),1));let t=ev.find(t=>t.id===e.employeeId||t.name===e.employeeName);t?(eG(t.name),eu(!0),q.Am.info("Navegando a: ".concat(t.name))):q.Am.info("Navegando a fecha: ".concat(a.toLocaleDateString()))}}catch(e){console.error("Error navegando",e)}if(e.id)try{let t="NOVEDAD"===e.source?"novedades":"ausencias",a=(0,G.JU)(K.db,t,e.id);await (0,G.r7)(a,{viewed:!0})}catch(e){console.error("Error marcar vista",e)}};(0,r.useEffect)(()=>{let e=(0,G.IO)((0,G.hJ)(K.db,"audit_logs"),(0,G.Xo)("timestamp","desc"),(0,G.b9)(20)),t=(0,G.cf)(e,e=>{let t=e.docs.map(e=>{var t;return{id:e.id,source:"AUDIT",timestamp:(null===(t=e.data().timestamp)||void 0===t?void 0:t.seconds)*1e3,label:$[e.data().action]||e.data().action,detail:e.data().details,actor:e.data().actorName,actorUid:e.data().actorUid}});eE(t)});return()=>t()},[]),(0,r.useEffect)(()=>{let e=new Date;e.setDate(e.getDate()-30);let t=e.toISOString().split("T")[0],a=(0,G.IO)((0,G.hJ)(K.db,"ausencias"),(0,G.ar)("startDate",">=",t)),s=(0,G.IO)((0,G.hJ)(K.db,"novedades"),(0,G.ar)("createdAt",">=",G.EK.fromDate(e))),r={ausencias:[],novedades:[]},updateState=()=>{let e=[...r.ausencias,...r.novedades].sort((e,t)=>t.createdAt-e.createdAt);eT(e),eZ(e.length>0)},l=(0,G.cf)(a,e=>{let t=e.docs.map(e=>({...e.data(),id:e.id,source:"AUSENCIA",createdAt:new Date(e.data().startDate).getTime()})).filter(e=>!e.viewed).map(e=>({id:e.id,title:e.type,msg:"".concat(e.employeeName," - ").concat(e.reason||"Sin motivo"),type:e.type,startDate:e.startDate,endDate:e.endDate,employeeId:e.employeeId,employeeName:e.employeeName,critical:!0,source:"AUSENCIA",createdAt:e.createdAt}));r.ausencias=t,updateState()}),n=(0,G.cf)(s,e=>{let t=e.docs.map(e=>({...e.data(),id:e.id})).filter(e=>!e.viewed&&"NOVEDAD_CIERRE"!==e.type).map(e=>{var t;return{id:e.id,title:e.type,msg:"".concat(e.employeeName," - ").concat(e.notes),date:e.createdAt,employeeId:e.employeeId||e.shiftId,employeeName:e.employeeName,critical:!0,source:"NOVEDAD",createdAt:(null===(t=e.createdAt)||void 0===t?void 0:t.seconds)?1e3*e.createdAt.seconds:Date.now()}});r.novedades=t,updateState()});return()=>{l(),n()}},[]),(0,r.useEffect)(()=>{if(!ed||!ex){eB([]);return}let fetchSLA=async()=>{try{let e=(0,G.IO)((0,G.hJ)(K.db,"servicios_sla"),(0,G.ar)("clientId","==",ed)),t=await (0,G.PL)(e),a=t.docs.map(e=>e.data()).find(e=>e.objectiveId===ex),s=[];(null==a?void 0:a.positions)&&a.positions.forEach(e=>{var t;(null===(t=e.allowedShiftTypes)||void 0===t?void 0:t.length)>0&&s.push({positionName:e.name||"General",shifts:e.allowedShiftTypes})}),0===s.length&&s.push({positionName:"General",shifts:[{code:"M",hours:8},{code:"T",hours:8},{code:"N",hours:8}]}),eB(s)}catch(e){eB([])}};fetchSLA()},[ed,ex]);let getObjectiveName=e=>{if(!e)return"Desconocido";for(let t of eS)if(t.objetivos){let a=t.objetivos.find(t=>(t.id||t.name)===e);if(a)return a.name}return e},loadHistory=async()=>{if(!ex){q.Am.error("Seleccione un objetivo");return}try{let e=(0,G.IO)((0,G.hJ)(K.db,"planificaciones_historial"),(0,G.ar)("period","==","".concat(eo.getMonth()+1,"-").concat(eo.getFullYear()))),t=await (0,G.PL)(e),a=t.docs.map(e=>({id:e.id,...e.data()})).filter(e=>e.objectiveId===ex).sort((e,t)=>t.timestamp.seconds-e.timestamp.seconds);ta(a),te(!0)}catch(e){q.Am.error("Error historial")}},tJ=(0,r.useMemo)(()=>{let e=new Date(eo.getFullYear(),eo.getMonth(),1),t=[];for(;e.getMonth()===eo.getMonth();)t.push(new Date(e)),e.setDate(e.getDate()+1);return t},[eo]),getEmployeeShiftCount=e=>{let t=0;return tJ.forEach(a=>{let s="".concat(e,"_").concat(getDateKey(a)),r=e4[s],l=ey[s];r?!r.isDeleted&&t++:l&&l.objectiveId===ex&&t++}),t},tK=(0,r.useMemo)(()=>{if(!ex&&!ep)return[];let e=ev;if(ex&&!ep){let t=new Set;Object.values(ey).forEach(e=>{e.objectiveId===ex&&t.add(e.employeeId)}),Object.entries(e4).forEach(e=>{let[a,s]=e,[r]=a.split("_");s.isDeleted||t.add(r)}),e=e.filter(e=>e.preferredObjectiveId===ex||t.has(e.id))}return eW&&(e=e.filter(e=>e.name.toLowerCase().includes(eW.toLowerCase()))),e.sort((e,t)=>{if("activity"===ef){let a=getEmployeeShiftCount(e.id),s=getEmployeeShiftCount(t.id);if(a!==s)return s-a}return e.name.localeCompare(t.name)})},[ev,ex,ep,eW,ey,e4,ef]),tW=(0,r.useMemo)(()=>{let e={};return eH&&Array.isArray(eH)&&eH.forEach(t=>{t.shifts&&Array.isArray(t.shifts)&&t.shifts.forEach(t=>{t&&t.code&&!e[t.code]&&(e[t.code]=t)})}),Object.values(e)},[eH]),checkLaborRules=(e,t,a)=>{let s=ev.find(t=>t.id===e);if(!s)return null;let r=getDateKey(t),l="".concat(e,"_").concat(r);if(ew[l])return"ALERTA CR\xcdTICA: El empleado tiene una Ausencia Registrada (".concat(ew[l].type,") para esta fecha.");let n=eC.find(e=>e.name===s.laborAgreement)||eC.find(e=>"General"===e.name)||{maxHoursWeekly:X.weekly,maxHoursMonthly:X.monthly},o=parseInt(n.maxHoursMonthly)||X.monthly,i=e4[l],d=ey[l],c=i?i.isDeleted?null:i:d;if(c&&("F"===c.code||c.isFranco))return"ALERTA CR\xcdTICA: El empleado ya tiene un FRANCO asignado este d\xeda.";getDateKey(t).substring(0,7);let x=0,m=new Date(t.getFullYear(),t.getMonth()+1,0).getDate();for(let a=1;a<=m;a++){let s=new Date(t.getFullYear(),t.getMonth(),a),r="".concat(e,"_").concat(getDateKey(s)),l=e4[r],n=ey[r],o=l?l.isDeleted?null:l:n;o&&"F"!==o.code&&(x+=Q[o.code]||o.hours||8)}return x+a>o?"ALERTA MENSUAL: L\xedmite de ".concat(o,"hs superado."):null},handleContextChange=(e,t)=>{if(Object.keys(e4).length>0){if(!confirm("⚠️ TIENES CAMBIOS SIN GUARDAR.\n\xbfDescartar y cambiar de objetivo?"))return;e5({})}ec(e),em(t),eG(""),e6({start:null,end:null}),tr(null)},findNeighbors=(e,t)=>{let a=[];Object.values(ey).forEach(s=>{if(s.objectiveId===e.objectiveId&&getDateKey(s.startTime)===t&&s.id!==e.id){let e="".concat(s.employeeId,"_").concat(t);if(!ew[e]){var r;a.push({...s,employeeName:(null===(r=ev.find(e=>e.id===s.employeeId))||void 0===r?void 0:r.name)||"Desconocido"})}}}),a.sort((e,t)=>e.startTime.seconds-t.startTime.seconds);let s=e.startTime.seconds,r=null,l=null;for(let e of a)e.startTime.seconds<s&&(r=e),e.startTime.seconds>s&&!l&&(l=e);tZ({prev:r,next:l})},handleMouseDown=(e,t)=>{ex&&!ts&&(e8(!0),e6({start:{r:e,c:t},end:{r:e,c:t}}))},isCellSelected=(e,t)=>e3.start&&e>=Math.min(e3.start.r,e3.end.r)&&e<=Math.max(e3.start.r,e3.end.r)&&t>=Math.min(e3.start.c,e3.end.c)&&t<=Math.max(e3.start.c,e3.end.c),resolveConflict=async e=>{if(!(null==eX?void 0:eX.currentShift))return;let t=(0,G.qs)(K.db),a=eX.currentShift.id;if(eX.absence?t.update((0,G.JU)(K.db,"turnos",a),{status:"ABSENT",comments:"Cubierto por ausencia"}):t.update((0,G.JU)(K.db,"turnos",a),{hasNovedad:!1,comments:"Novedad resuelta"}),"SPLIT"===e)(null==tz?void 0:tz.prev)&&t.update((0,G.JU)(K.db,"turnos",tz.prev.id),{isExtended:!0,comments:"Extensi\xf3n por cobertura"}),(null==tz?void 0:tz.next)&&t.update((0,G.JU)(K.db,"turnos",tz.next.id),{isEarlyStart:!0,comments:"Adelanto por cobertura"}),q.Am.success("Cobertura aplicada: Extensi\xf3n + Adelanto");else{tO(!1),tn("FT_SELECTION");return}await t.commit(),tO(!1),eQ(null)},handleRRHHSubmit=async()=>{if(eX)try{var e;await (0,G.ET)((0,G.hJ)(K.db,"ausencias"),{employeeId:eX.empId,employeeName:null===(e=ev.find(e=>e.id===eX.empId))||void 0===e?void 0:e.name,startDate:eX.dateStr,endDate:eX.dateStr,type:tI.type,reason:tI.reason,status:"APPROVED",createdAt:(0,G.Bt)()}),q.Am.success("Ausencia cargada por RRHH"),tE(!1),eQ(null)}catch(e){q.Am.error("Error al cargar ausencia")}},handleAssignShift=async(e,t)=>{if(!eX)return;if(isDateLocked(eX.dateStr)){q.Am.error("Periodo cerrado.");return}"".concat(eX.empId,"_").concat(eX.dateStr);let a=eX.currentShift,s="FT_SELECTION"===tl;if(a&&a.objectiveId!==ex&&!a.isFranco&&!s){let t=getObjectiveName(a.objectiveId);if(!confirm('⚠️ ALERTA DE TRANSFERENCIA\n\nEl empleado ya tiene turno en "'.concat(t,'".\n\n\xbfDesea moverlo a este objetivo?')))return;applyToPending({...e,oldObjectiveId:a.objectiveId});return}if(a&&("F"===a.code||a.isFranco)&&"F"!==e.code&&!s&&!confirm("⚠️ ATENCI\xd3N: EST\xc1 ELIMINANDO UN FRANCO\n\n\xbfSeguro que desea eliminar el Franco?"))return;let[r,l,n]=eX.dateStr.split("-").map(Number),o=new Date(r,l-1,n),i=e.hours||8;if("F"!==e.code&&!s){let a=checkLaborRules(eX.empId,o,i);if(a){if(e2(a),a.includes("CR\xcdTICA")){q.Am.error(a);return}e0({shiftConfig:e,positionName:t,targetDate:o});return}}applyToPending({...e,isFrancoTrabajado:s,isExtended:tH.extend,isEarlyStart:tH.early,plannedNovedad:tH.plannedNovedad})},applyToPending=e=>{let t="".concat(eX.empId,"_").concat(eX.dateStr),a={...e4};a[t]={...e,isTemp:!0,isFranco:"F"===e.code||"FF"===e.code||e.isFranco,swapWith:e.swapWith||null,swapDate:e.swapDate||null},e5(a),eQ(null),e0(null),tc(null),ti(!1),q.Am.info("Cambio aplicado")},handleSelectDate=e=>{tu(e),tj(!0);let getShiftInfo=(e,t)=>{let a="".concat(e,"_").concat(t);return e4[a]||ey[a]},t=getShiftInfo(tx,eX.dateStr);t&&"F"!==t.code&&"FF"!==t.code?(tN(t.code),tA(!0)):(tN("M"),tA(!1));let a=getShiftInfo(eX.empId,e);a&&"F"!==a.code&&"FF"!==a.code?(tk(a.code),tD(!0)):(tk("M"),tD(!1))};(0,r.useEffect)(()=>{if(tx){let e=[];Object.values(ey).forEach(t=>{if(t.employeeId===tx&&("F"===t.code||t.isFranco)){let[a,s,r]=getDateKey(t.startTime).split("-");e.push({dateStr:getDateKey(t.startTime),label:"".concat(r,"/").concat(s)})}}),tg(e)}else tg([])},[tx,ey]);let tG=(0,r.useMemo)(()=>to?ev.filter(e=>e.id!==(null==td?void 0:td.empId)).filter(e=>e.name.toLowerCase().includes(th.toLowerCase())).sort((e,t)=>e.name.localeCompare(t.name)):[],[ev,to,th,td]),handleDelete=async()=>{if(!eX)return;if(isDateLocked(eX.dateStr)){q.Am.warning("Bloqueado.");return}let e="".concat(eX.empId,"_").concat(eX.dateStr),t={...e4};t[e]={isDeleted:!0},e5(t),eQ(null),q.Am.info("Marcado para borrar.")},getSafeTime=e=>{if(!e)return[6,0];if("string"==typeof e)return e.split(":").map(Number);if(e.toDate){let t=e.toDate();return[t.getHours(),t.getMinutes()]}if(e.seconds){let t=new Date(1e3*e.seconds);return[t.getHours(),t.getMinutes()]}return e instanceof Date?[e.getHours(),e.getMinutes()]:[6,0]},handleSaveAll=async()=>{let e=Object.keys(e4).length;if(0===e||!confirm("\xbfConfirmar y guardar ".concat(e," cambios?")))return;eb(!0);let t=(0,G.qs)(K.db),a=(0,W.v0)(),s=eV[e_]||eL||"Sistema",r=[],l={};tK.forEach(e=>{tJ.forEach(t=>{let a="".concat(e.id,"_").concat(getDateKey(t)),s=e4[a],r=ey[a];s?s.isDeleted||(l[a]={code:s.code,isFranco:s.isFranco,isFrancoTrabajado:s.isFrancoTrabajado,isFrancoCompensatorio:s.isFrancoCompensatorio,swapWith:s.swapWith,objectiveId:ex,isExtended:s.isExtended,isEarlyStart:s.isEarlyStart}):r&&r.objectiveId===ex&&(l[a]={code:r.code,isFranco:r.isFranco,isFrancoTrabajado:r.isFrancoTrabajado,isFrancoCompensatorio:r.isFrancoCompensatorio,swapWith:r.swapWith,objectiveId:ex,isExtended:r.isExtended,isEarlyStart:r.isEarlyStart})})});try{for(let[e,l]of Object.entries(e4)){let[o,i]=e.split("_"),d=ey[e],c=ev.find(e=>e.id===o),x=c?c.name:"Desconocido",m="ASIGNACION_MASIVA",p="Asign\xf3 ".concat(l.code," a ").concat(x," el ").concat(i);if(l.isDeleted)m="ELIMINACION_MASIVA",p="Borr\xf3 turno de ".concat(x," el ").concat(i),(null==d?void 0:d.id)&&t.delete((0,G.JU)(K.db,"turnos",d.id));else{var n;(null==d?void 0:d.id)&&t.delete((0,G.JU)(K.db,"turnos",d.id)),d&&(("F"===d.code||d.isFranco)&&"F"!==l.code?l.isFrancoTrabajado?(m="CAMBIO_FRANCO_TURNO",p="Asign\xf3 FT (".concat(l.code,") a ").concat(x," el ").concat(i)):(m="CAMBIO_DIAGRAMA",p="Cambio de Diagrama (F x ".concat(l.code,") a ").concat(x)):"F"!==d.code&&"F"===l.code&&l.isFrancoCompensatorio&&(m="CAMBIO_TURNO_FRANCO",p="Asign\xf3 FF a ".concat(x," el ").concat(i)));let[e,c,u]=i.split("-").map(Number),h=new Date(e,c-1,u),[b,f]=getSafeTime(l.startTime),g=new Date(h);g.setHours(b,f,0);let v=new Date(g);"F"===l.code||"FF"===l.code?v.setHours(23,59,59):v.setTime(g.getTime()+36e5*(l.hours||8));let j=l.swapWith||null,y=l.swapDate||null;t.set((0,G.JU)((0,G.hJ)(K.db,"turnos")),{employeeId:o,clientId:ed,objectiveId:ex,code:l.isFrancoCompensatorio?"FF":l.code,type:l.name||l.code,startTime:G.EK.fromDate(g),endTime:G.EK.fromDate(v),isFranco:"F"===l.code||l.isFrancoCompensatorio||!0===l.isFranco,isFrancoTrabajado:l.isFrancoTrabajado||!1,isFrancoCompensatorio:l.isFrancoCompensatorio||!1,swapWith:j,swapDate:y,createdAt:(0,G.Bt)(),comments:"Carga Masiva",isExtended:l.isExtended||!1,isEarlyStart:l.isEarlyStart||!1,plannedNovedad:l.plannedNovedad||null}),r.push({empId:o,date:i,action:m}),t.set((0,G.JU)((0,G.hJ)(K.db,"audit_logs")),{action:m,module:"PLANIFICADOR",details:p,timestamp:(0,G.Bt)(),actorName:s,actorUid:null===(n=a.currentUser)||void 0===n?void 0:n.uid})}}await (0,G.ET)((0,G.hJ)(K.db,"planificaciones_historial"),{timestamp:(0,G.Bt)(),user:s,period:"".concat(eo.getMonth()+1,"-").concat(eo.getFullYear()),objectiveId:ex,changes:r,count:e,snapshot:JSON.stringify(l)}),await t.commit(),e5({}),q.Am.success("Guardado exitoso")}catch(e){console.error(e),q.Am.error("Error al guardar")}finally{eb(!1)}},handleViewSnapshot=e=>{try{let t=JSON.parse(e.snapshot);tr({id:e.id,date:new Date(1e3*e.timestamp.seconds),user:e.user,data:t}),te(!1)}catch(e){q.Am.error("Error al cargar versi\xf3n hist\xf3rica")}},handleUnassignEmployee=async e=>{if(ex){if(e.preferredObjectiveId!==ex){q.Am.error("Error asignaci\xf3n.");return}if(confirm("\xbfCONFIRMAR DESVINCULACI\xd3N?"))try{var t;await (0,G.r7)((0,G.JU)(K.db,"empleados",e.id),{preferredObjectiveId:null}),await (0,G.ET)((0,G.hJ)(K.db,"audit_logs"),{action:"DESVINCULACION_OBJETIVO",module:"PLANIFICADOR",details:"Desvincul\xf3 a ".concat(e.name),timestamp:(0,G.Bt)(),actorName:eL,actorUid:null===(t=(0,W.v0)().currentUser)||void 0===t?void 0:t.uid}),q.Am.success("Desvinculado")}catch(e){q.Am.error("Error")}}},applyBulkChange=e=>{if(!e3.start||!e3.end)return;let t=tJ[Math.min(e3.start.c,e3.end.c)];if(isDateLocked(getDateKey(t))){q.Am.warning("Periodo cerrado.");return}let a=Math.min(e3.start.r,e3.end.r),s=Math.max(e3.start.r,e3.end.r),r=Math.min(e3.start.c,e3.end.c),l=Math.max(e3.start.c,e3.end.c),n={...e4},o=0,i=0;for(let t=a;t<=s;t++){let a=tK[t];if(a)for(let t=r;t<=l;t++){let s=tJ[t],r="".concat(a.id,"_").concat(getDateKey(s)),l=ey[r];l&&("F"===l.code||l.isFranco)&&e&&"F"!==e.code&&i++}}let d=!1;i>0&&confirm("⚠️ Est\xe1s sobrescribiendo ".concat(i," Francos.\n\xbfDeseas marcarlos como FT?"))&&(d=!0);for(let t=a;t<=s;t++){let a=tK[t];if(a)for(let t=r;t<=l;t++){let s=tJ[t],r="".concat(a.id,"_").concat(getDateKey(s)),l=ey[r];if(!isShiftConsolidated(l)){if(null===e)n[r]={isDeleted:!0};else{let t=!1;l&&("F"===l.code||l.isFranco)&&"F"!==e.code&&(t=d),n[r]={...e,isTemp:!0,oldObjectiveId:null==l?void 0:l.objectiveId,isFrancoTrabajado:t}}o++}}}e5(n),q.Am.info("".concat(o," celdas"))},renderGrid=(e,t)=>(0,s.jsxs)("table",{className:"border-collapse w-full text-xs",children:[(0,s.jsx)("thead",{className:"sticky top-0 z-30 bg-slate-100 shadow-md h-10",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"sticky left-0 z-40 bg-slate-100 p-2 text-left min-w-[150px] border-b border-r",children:(0,s.jsxs)("span",{className:"text-[10px] font-black uppercase",children:[(0,s.jsx)(i.Z,{size:12})," Dotaci\xf3n"]})}),tJ.map(e=>(0,s.jsx)("th",{className:"min-w-[25px] border-b border-r p-1 text-center ".concat([0,6].includes(e.getDay())?"bg-slate-200":""),children:(0,s.jsx)("span",{className:"text-[10px] font-bold",children:e.getDate()})},e.toISOString()))]})}),(0,s.jsx)("tbody",{children:tK.map((a,r)=>(0,s.jsxs)("tr",{className:"group hover:bg-slate-50",children:[(0,s.jsxs)("td",{className:"sticky left-0 z-20 bg-white p-2 border-r border-b shadow-sm group-hover:bg-slate-50 flex justify-between items-center h-8",children:[(0,s.jsxs)("span",{className:"text-[9px] font-bold truncate w-32 flex items-center gap-1",children:[a.name,ex&&a.preferredObjectiveId!==ex&&(0,s.jsx)(c,{size:10,className:"text-indigo-500"})]}),!e&&ex&&a.preferredObjectiveId===ex&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),handleUnassignEmployee(a)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-rose-100 text-rose-400 hover:text-rose-600 rounded transition-all ml-1",title:"Desvincular del Objetivo",children:(0,s.jsx)(x.Z,{size:12})})]}),tJ.map((l,n)=>{let o,i;let d="".concat(a.id,"_").concat(getDateKey(l));if(e&&t){let e=t[d];e&&(o={...e,id:"history",objectiveId:ex}),i=null}else o=ey[d],i=e4[d];let c=!e&&isCellSelected(r,n),x=!e&&isDateLocked(getDateKey(l)),u=null,h="",b=(null==o?void 0:o.isFrancoTrabajado)||(null==i?void 0:i.isFrancoTrabajado),f=(null==o?void 0:o.isFrancoCompensatorio)||(null==i?void 0:i.isFrancoCompensatorio),g=(null==o?void 0:o.isExtended)||(null==i?void 0:i.isExtended),v=(null==o?void 0:o.isEarlyStart)||(null==i?void 0:i.isEarlyStart),j=(null==o?void 0:o.plannedNovedad)||(null==i?void 0:i.plannedNovedad),y=ew[d],N=o&&y&&"ABSENT"!==o.status||o&&o.hasNovedad,w=null;o&&!e&&("PRESENT"===o.status||"COMPLETED"===o.status?w="bg-emerald-500":"ABSENT"===o.status&&(w="bg-rose-500"));let k=(null==o?void 0:o.swapWith)||(null==i?void 0:i.swapWith);return!o||o.objectiveId===ex||o.isFranco||b||f||["V","L","A","E"].includes(o.code),x?(h=Y.PAST,o&&(u=o.code)):i?i.isDeleted?(u=(0,s.jsx)(m.Z,{size:12}),h="bg-rose-50 text-rose-300"):b?(h=Y.FT,u="FT"):f?(h=Y.FF,u="FF"):(u=i.code,h="bg-amber-100 text-amber-700 font-black ring-2 ring-amber-400 ".concat(k?Y.SWAP:"")):o&&!x&&(b?(h=Y.FT,u="FT"):f?(h=Y.FF,u="FF"):(h="".concat(getDefaultStyle(o.code)," ").concat(k?Y.SWAP:""),u=o.code)),g&&(h+=" ring-2 ring-violet-600 z-10"),v&&(h+=" ring-2 ring-cyan-500 z-10"),"AVISO"===j&&(h+=" border-l-4 border-l-amber-500"),"LICENCIA"===j&&(h+=" border-l-4 border-l-purple-500"),y&&(h=Y.V||"bg-teal-600 text-white font-black",u="V","Vacaciones"===y.type?u="V":"Enfermedad"===y.type?(u="E",h=Y.E):(u="AUS",h="bg-rose-50 text-rose-700 font-bold border-rose-200")),(0,s.jsx)("td",{onMouseDown:()=>!e&&handleMouseDown(r,n),onMouseEnter:()=>!e&&e7&&e6(e=>({...e,end:{r:r,c:n}})),className:"border-b border-r p-0.5 ".concat(e||x?"cursor-default":"cursor-pointer"," text-center relative ").concat(c?"bg-indigo-200":""),children:(0,s.jsxs)("div",{className:"w-full h-6 rounded flex items-center justify-center text-[9px] font-black relative ".concat(h),children:[u,(g||v)&&(0,s.jsx)("div",{className:"absolute -top-1 -right-1 text-[8px] bg-slate-800 text-white px-1 rounded-full",children:"+"}),w&&(0,s.jsx)("div",{className:"absolute top-0 right-0 w-2 h-2 rounded-full border border-white ".concat(w)}),N&&(0,s.jsx)("div",{className:"absolute inset-0 bg-red-500/30 flex items-center justify-center animate-pulse border-2 border-red-500 z-20",children:(0,s.jsx)(p.Z,{size:14,className:"text-white drop-shadow-md"})})]})},d)})]},a.id))})]});return(0,s.jsxs)(o.Z,{children:[(0,s.jsx)(n(),{children:(0,s.jsx)("title",{children:"Planificador"})}),(0,s.jsx)("style",{children:".pattern-grid { background-image: linear-gradient(45deg, #e5e7eb 25%, transparent 25%, transparent 75%, #e5e7eb 75%, #e5e7eb), linear-gradient(45deg, #e5e7eb 25%, transparent 25%, transparent 75%, #e5e7eb 75%, #e5e7eb); background-size: 10px 10px; background-position: 0 0, 5px 5px; } @media print { @page { size: A4 landscape; margin: 5mm; } body { -webkit-print-color-adjust: exact; print-color-adjust: exact; background-color: white !important; } #printable-section { position: absolute; left: 0; top: 0; width: 100%; min-width: 100%; transform: none; background: white; } .no-print { display: none !important; } .custom-scrollbar { overflow: visible !important; height: auto !important; } }"}),(0,s.jsx)(q.x7,{position:"top-center"}),(0,s.jsxs)("div",{className:"flex flex-col h-[calc(100vh-100px)] p-2 space-y-4 animate-in fade-in select-none",onMouseUp:()=>{if(e8(!1),e3.start&&e3.end&&e3.start.r===e3.end.r&&e3.start.c===e3.end.c){var e;let t=tK[e3.start.r],a=tJ[e3.start.c],s=getDateKey(a),r="".concat(t.id,"_").concat(s),l=e4[r]||ey[r],n=ew[r];if(e3.start.r===e3.end.r&&e3.start.c===e3.end.c&&e6({start:null,end:null}),!(null===(e=e4[r])||void 0===e?void 0:e.isDeleted)){if(isShiftConsolidated(l)){eQ({empId:t.id,dateStr:s,currentShift:l,absence:n});return}let e=isDateLocked(s);if(!e&&(l&&n||l&&l.hasNovedad))findNeighbors(l,s),eQ({empId:t.id,dateStr:s,currentShift:l,absence:n}),tO(!0);else{if(!e){let e={extend:!1,early:!1,plannedNovedad:""};l&&(e={extend:l.isExtended||!1,early:l.isEarlyStart||!1,plannedNovedad:l.plannedNovedad||""}),tB(e),tn("NONE")}eQ({empId:t.id,dateStr:s,currentShift:l,absence:n})}}}},children:[(0,s.jsx)("div",{className:"bg-white p-3 rounded-2xl shadow-sm border flex flex-wrap items-center justify-between gap-3 shrink-0",children:ts?(0,s.jsxs)("div",{className:"flex-1 bg-amber-50 border-amber-200 border px-4 py-2 rounded-xl flex justify-between items-center animate-in slide-in-from-top no-print shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg text-amber-700",children:(0,s.jsx)(u,{size:20})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-black text-amber-800 uppercase",children:"Modo Comparaci\xf3n Activado"}),(0,s.jsxs)("p",{className:"text-[10px] text-amber-600",children:["Comparando Actualidad vs. Versi\xf3n del ",ts.date.toLocaleString()]})]})]}),(0,s.jsxs)("button",{onClick:()=>tr(null),className:"bg-amber-600 text-white px-4 py-2 rounded-lg text-xs font-black hover:bg-amber-700 shadow-sm flex items-center gap-2",children:[(0,s.jsx)(m.Z,{size:14})," CERRAR COMPARACI\xd3N"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex gap-2 no-print",children:[(0,s.jsxs)("select",{value:ed,onChange:e=>handleContextChange(e.target.value,""),className:"bg-slate-50 border p-2 rounded-xl text-xs font-bold w-40",children:[(0,s.jsx)("option",{value:"",children:"Cliente..."}),eS.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("select",{value:ex,onChange:e=>handleContextChange(ed,e.target.value),className:"bg-slate-50 border p-2 rounded-xl text-xs font-bold w-40",children:[(0,s.jsx)("option",{value:"",children:"Objetivo..."}),null===(t=eS.find(e=>e.id===ed))||void 0===t?void 0:null===(e=t.objetivos)||void 0===e?void 0:e.map(e=>(0,s.jsx)("option",{value:e.id||e.name,children:e.name},e.id||e.name))]})]}),Object.keys(e4).length>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2 animate-in slide-in-from-top-2 bg-amber-50 p-1.5 rounded-xl border border-amber-200 shadow-lg no-print",children:[(0,s.jsxs)("span",{className:"text-[10px] font-bold text-amber-700 uppercase tracking-widest hidden md:inline",children:["Planificando como: ",eL]}),(0,s.jsx)("div",{className:"h-4 w-px bg-amber-200 mx-1"}),(0,s.jsxs)("span",{className:"text-xs font-black text-amber-700 px-1",children:[Object.keys(e4).length," cambios"]}),(0,s.jsx)("button",{onClick:()=>e5({}),className:"p-1.5 hover:bg-amber-100 rounded-lg text-amber-600",children:(0,s.jsx)(h.Z,{size:16})}),(0,s.jsxs)("button",{onClick:handleSaveAll,className:"bg-amber-500 hover:bg-amber-600 text-white px-4 py-2 rounded-lg text-xs font-black flex items-center gap-2 shadow",children:[(0,s.jsx)(b.Z,{size:14})," GUARDAR"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 no-print",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>{eO(!eM),eZ(!1)},className:"p-2 bg-slate-100 hover:bg-slate-200 rounded-xl relative",children:[(0,s.jsx)(f.Z,{size:18}),ez&&(0,s.jsx)("span",{className:"absolute top-0 right-0 w-3 h-3 bg-rose-500 rounded-full border-2 border-white animate-pulse"})]}),eM&&(0,s.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white rounded-2xl shadow-2xl border overflow-hidden z-50 animate-in zoom-in-95",children:[(0,s.jsxs)("div",{className:"p-3 bg-slate-50 border-b flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"font-black text-xs uppercase text-slate-500",children:"Alertas"}),(0,s.jsx)("button",{onClick:()=>eO(!1),children:(0,s.jsx)(m.Z,{size:14})})]}),(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto",children:eI.length>0?eI.map((e,t)=>(0,s.jsxs)("div",{className:"p-3 border-b last:border-0 hover:bg-slate-50 flex gap-3 items-start cursor-pointer",onClick:()=>handleNotificationClick(e),children:[(0,s.jsx)("div",{className:"p-2 rounded-full bg-amber-100 text-amber-600",children:(0,s.jsx)(g.Z,{size:16})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-bold text-slate-800",children:e.title}),(0,s.jsx)("p",{className:"text-[10px] text-slate-500",children:e.msg}),(0,s.jsx)("p",{className:"text-[9px] font-mono text-slate-400 mt-1",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():e.date})]})]},t)):(0,s.jsx)("div",{className:"p-6 text-center text-slate-400 text-xs",children:"Sin novedades recientes."})})]})]}),(0,s.jsxs)("div",{className:"flex items-center bg-slate-100 rounded-xl p-1",children:[(0,s.jsx)("button",{onClick:()=>ei(new Date(eo.getFullYear(),eo.getMonth()-1,1)),className:"p-1 hover:bg-white rounded-lg",children:(0,s.jsx)(v.Z,{size:16})}),(0,s.jsx)("span",{className:"px-3 font-black text-xs w-24 text-center capitalize",children:eo.toLocaleDateString("es-AR",{month:"long"})}),(0,s.jsx)("button",{onClick:()=>ei(new Date(eo.getFullYear(),eo.getMonth()+1,1)),className:"p-1 hover:bg-white rounded-lg",children:(0,s.jsx)(j.Z,{size:16})})]}),(0,s.jsx)("button",{onClick:loadHistory,className:"p-2 bg-slate-100 rounded-lg hover:bg-indigo-50 hover:text-indigo-600 transition-colors",title:"Ver Historial",disabled:!ex,children:(0,s.jsx)(y,{size:18})}),(0,s.jsx)("button",{onClick:()=>eg(e=>"name"===e?"activity":"name"),className:"p-2 bg-slate-100 hover:bg-indigo-50 hover:text-indigo-600 rounded-xl transition-colors border border-transparent hover:border-indigo-200",title:"activity"===ef?"Ordenado por Actividad":"Ordenado por Nombre",children:"activity"===ef?(0,s.jsx)(N,{size:18}):(0,s.jsx)(w,{size:18})}),(0,s.jsxs)("button",{onClick:()=>eu(!ep),className:"px-3 py-2 rounded-xl text-xs font-black uppercase flex items-center gap-2 border transition-colors ".concat(ep?"bg-amber-100 text-amber-700 border-amber-200":"bg-white border-slate-200 text-slate-500"),children:[ep?(0,s.jsx)(k.Z,{size:14}):(0,s.jsx)(S.Z,{size:14})," ",ep?"Ver Todos":"Dotaci\xf3n"]}),(0,s.jsxs)("button",{onClick:()=>eK(!0),disabled:!ex,className:"bg-slate-900 text-white px-3 py-2 rounded-xl text-xs font-black uppercase flex items-center gap-2 hover:bg-slate-800 disabled:opacity-50",children:[(0,s.jsx)(A.Z,{size:14})," Asignar"]})]})]})}),e3.start&&(e3.start.r!==(null===(a=e3.end)||void 0===a?void 0:a.r)||e3.start.c!==(null===(l=e3.end)||void 0===l?void 0:l.c))&&!ts&&(0,s.jsxs)("div",{className:"absolute top-24 left-1/2 -translate-x-1/2 z-[60] bg-slate-800 text-white p-2 rounded-2xl shadow-2xl flex gap-1 animate-in zoom-in-95 items-center border border-slate-600 no-print",children:[(0,s.jsx)("span",{className:"text-[10px] font-bold px-2 text-slate-300 uppercase tracking-wider",children:"Asignar:"}),tW.map(e=>(0,s.jsx)("button",{onClick:()=>applyBulkChange({code:e.code,name:e.name,hours:e.hours,startTime:e.startTime}),className:"w-8 h-8 rounded-lg font-black text-xs ".concat(getDefaultStyle(e.code)),children:e.code},e.code)),(0,s.jsx)("button",{onClick:()=>applyBulkChange({code:"F",name:"Franco",hours:0,startTime:"00:00"}),className:"w-8 h-8 rounded-lg bg-emerald-600 text-white font-black text-xs border border-emerald-700",children:"F"}),(0,s.jsx)("div",{className:"h-6 w-px bg-slate-600 mx-2"}),(0,s.jsxs)("button",{onClick:()=>tE(!0),className:"p-2 bg-amber-600 hover:bg-amber-700 rounded-lg text-white font-bold text-xs flex items-center gap-2 shadow-sm",children:[(0,s.jsx)(C.Z,{size:12})," +Ausencia"]}),(0,s.jsx)("div",{className:"h-6 w-px bg-slate-600 mx-2"}),(0,s.jsx)("button",{onClick:()=>applyBulkChange(null),className:"p-2 hover:bg-rose-600 rounded-lg text-rose-300 hover:text-white transition-colors",title:"Borrar",children:(0,s.jsx)(D.Z,{size:16})}),(0,s.jsx)("button",{onClick:()=>e6({start:null,end:null}),className:"ml-1 p-2 hover:bg-slate-700 rounded-lg",children:(0,s.jsx)(m.Z,{size:16})})]}),(0,s.jsxs)("div",{id:"printable-section",className:"flex-1 rounded-2xl border shadow-xl overflow-hidden flex flex-col relative select-none bg-slate-100 gap-1",children:[(0,s.jsxs)("div",{className:"flex-1 bg-white flex flex-col overflow-hidden ".concat(ts?"rounded-t-2xl border-b-4 border-slate-300":"rounded-2xl"),children:[(0,s.jsx)("div",{className:"hidden print:block p-4 border-b text-center mb-2",children:(0,s.jsx)("h1",{className:"text-xl font-black uppercase text-slate-900",children:"Planificaci\xf3n Mensual"})}),ts&&(0,s.jsx)("div",{className:"px-4 py-1 bg-white text-[10px] font-black uppercase text-slate-400 border-b flex justify-between",children:(0,s.jsx)("span",{children:"VISTA ACTUAL (EN VIVO)"})}),(0,s.jsx)("div",{className:"flex-1 overflow-auto custom-scrollbar",children:renderGrid(!1)})]}),ts&&(0,s.jsxs)("div",{className:"flex-1 bg-amber-50/50 flex flex-col overflow-hidden rounded-b-2xl animate-in slide-in-from-bottom duration-300",children:[(0,s.jsxs)("div",{className:"px-4 py-1 bg-amber-100 text-[10px] font-black uppercase text-amber-700 border-b border-amber-200 flex justify-between items-center shadow-sm",children:[(0,s.jsxs)("span",{children:["VISTA HIST\xd3RICA: ",ts.date.toLocaleString()]}),(0,s.jsxs)("span",{className:"text-[9px] opacity-75",children:["Por: ",ts.user]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto custom-scrollbar bg-amber-50",children:renderGrid(!0,ts.data)})]})]}),eX&&!e$&&!ts&&!to&&!tM&&!tF&&!tL&&(0,s.jsx)("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 no-print",children:(0,s.jsxs)("div",{className:"bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl animate-in zoom-in-95",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-black text-lg uppercase",children:null===(d=ev.find(e=>e.id===eX.empId))||void 0===d?void 0:d.name}),(0,s.jsx)("p",{className:"text-xs text-slate-500 font-bold",children:eX.dateStr})]}),(0,s.jsx)("button",{onClick:()=>eQ(null),className:"p-2 bg-slate-100 rounded-full hover:bg-slate-200",children:(0,s.jsx)(m.Z,{size:16})})]}),((null===(ee=eX.currentShift)||void 0===ee?void 0:ee.code)==="F"||(null===(et=eX.currentShift)||void 0===et?void 0:et.isFranco))&&"NONE"===tl?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-6 bg-emerald-50 rounded-2xl border border-emerald-200 text-center",children:[(0,s.jsx)("h3",{className:"text-2xl font-black text-emerald-700",children:"FRANCO"}),(0,s.jsx)("p",{className:"text-xs text-emerald-600 mt-2",children:"\xbfQu\xe9 desea hacer con este franco?"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{onClick:()=>tn("FT_SELECTION"),className:"p-4 bg-violet-50 hover:bg-violet-100 border border-violet-200 rounded-xl flex flex-col items-center gap-2 transition-colors",children:[(0,s.jsx)(F,{size:24,className:"text-violet-600"}),(0,s.jsx)("span",{className:"text-[10px] font-black text-violet-700 uppercase",children:"Franco Trabajado (FT)"})]}),(0,s.jsxs)("button",{onClick:()=>{tc({empId:eX.empId,dateStr:eX.dateStr,oldShift:eX.currentShift}),tb(""),ti(!0)},className:"p-4 bg-cyan-50 hover:bg-cyan-100 border border-cyan-200 rounded-xl flex flex-col items-center gap-2 transition-colors",children:[(0,s.jsx)(E,{size:24,className:"text-cyan-600"}),(0,s.jsx)("span",{className:"text-[10px] font-black text-cyan-700 uppercase",children:"Intercambiar (FF)"})]})]}),!isShiftConsolidated(eX.currentShift)&&(0,s.jsxs)("button",{onClick:handleDelete,className:"w-full py-3 bg-slate-100 text-slate-500 rounded-xl font-bold text-xs hover:bg-slate-200 flex items-center justify-center gap-2",children:[(0,s.jsx)(D.Z,{size:14})," Borrar / Dejar Vac\xedo"]})]}):(0,s.jsxs)(s.Fragment,{children:[eX.currentShift?(0,s.jsxs)("div",{className:"mb-6 p-4 border rounded-2xl text-center relative ".concat(eX.currentShift.isFrancoTrabajado?"bg-violet-50 border-violet-200":eX.currentShift.isFrancoCompensatorio?"bg-cyan-50 border-cyan-200":"bg-indigo-50 border-indigo-100"),children:[isShiftConsolidated(eX.currentShift)&&(0,s.jsxs)("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-[9px] font-black px-3 py-1 rounded-full uppercase flex items-center gap-1 shadow-md z-10",children:[(0,s.jsx)(I.Z,{size:10})," Consolidado / Solo Lectura"]}),eX.currentShift.isFrancoTrabajado?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F,{size:32,className:"mx-auto text-violet-600 mb-2"}),(0,s.jsx)("h3",{className:"text-xl font-black text-violet-700 uppercase",children:"Franco Trabajado"}),(0,s.jsxs)("p",{className:"text-[10px] font-bold text-violet-500 mt-1",children:["Cubri\xf3 turno: ",(0,s.jsx)("span",{className:"text-lg",children:eX.currentShift.code})]}),(0,s.jsx)("div",{className:"mt-2 bg-white/50 p-1.5 rounded border border-violet-100 inline-block",children:(0,s.jsxs)("p",{className:"text-[9px] font-bold text-violet-800 flex items-center gap-1 justify-center",children:[(0,s.jsx)(T.Z,{size:10})," ",getObjectiveName(eX.currentShift.objectiveId||ex)]})})]}):eX.currentShift.isFrancoCompensatorio?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E,{size:32,className:"mx-auto text-cyan-600 mb-2"}),(0,s.jsx)("h3",{className:"text-xl font-black text-cyan-700 uppercase",children:"Franco Compensatorio"}),(0,s.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-cyan-200 mt-2 shadow-sm text-left",children:[(0,s.jsxs)("p",{className:"text-[10px] text-cyan-500 font-bold uppercase mb-1 flex items-center gap-1",children:[(0,s.jsx)(M.Z,{size:10})," Intercambio con:"]}),(0,s.jsx)("p",{className:"text-sm font-black text-slate-800 mb-2",children:eX.currentShift.swapWith||"---"}),(0,s.jsx)("div",{className:"h-px bg-cyan-100 my-2"}),(0,s.jsxs)("p",{className:"text-[10px] text-cyan-500 font-bold uppercase mb-1 flex items-center gap-1",children:[(0,s.jsx)(O,{size:10})," Fecha Devuelta:"]}),(0,s.jsx)("p",{className:"text-sm font-bold text-slate-600",children:eX.currentShift.swapDate||"---"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-[10px] font-black text-indigo-400 uppercase",children:"Turno Actual"}),(0,s.jsx)("p",{className:"text-3xl font-black text-indigo-700 mt-1",children:eX.currentShift.code}),(0,s.jsx)("div",{className:"my-2 bg-white/60 p-2 rounded-lg border border-indigo-200 inline-block",children:(0,s.jsxs)("p",{className:"text-xs font-bold text-slate-700 flex items-center justify-center gap-2",children:[(0,s.jsx)(z.Z,{size:12}),(()=>{let e=eX.currentShift.code,t=tW.find(t=>t.code===e);return t&&t.startTime&&t.endTime?"".concat(t.startTime," - ").concat(t.endTime):t&&t.hours?"".concat(t.hours," horas"):"Horario Est\xe1ndar"})()]})}),eX.currentShift.swapWith&&(0,s.jsxs)("p",{className:"text-[9px] text-cyan-600 mt-1 font-bold",children:["\uD83D\uDD01 Cubre a: ",eX.currentShift.swapWith]}),eX.currentShift.realStartTime&&(0,s.jsxs)("div",{className:"mt-3 pt-3 border-t border-indigo-200/50",children:[(0,s.jsx)("p",{className:"text-[9px] font-black uppercase text-slate-400",children:"Datos Reales (Operaciones)"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs mt-1",children:[(0,s.jsx)("span",{className:"font-bold text-slate-600",children:"Entrada:"}),(0,s.jsx)("span",{className:"font-mono text-indigo-600 font-bold",children:formatTime(eX.currentShift.realStartTime)})]}),"ABSENT"===eX.currentShift.status&&(0,s.jsx)("div",{className:"bg-rose-100 text-rose-600 text-xs font-bold px-2 py-1 rounded mt-2 uppercase text-center",children:"Ausente"})]})]}),!isShiftConsolidated(eX.currentShift)&&(0,s.jsx)("button",{onClick:handleDelete,className:"absolute top-2 right-2 p-2 text-rose-400 hover:text-rose-600 hover:bg-rose-50 rounded-full",children:(0,s.jsx)(D.Z,{size:16})})]}):(0,s.jsx)("div",{className:"p-4 text-center text-slate-400 text-xs italic mb-4",children:"Celda vac\xeda"}),isShiftConsolidated(eX.currentShift)?(0,s.jsxs)("div",{className:"text-center p-4 bg-slate-50 rounded-xl border border-slate-200",children:[(0,s.jsx)("p",{className:"text-xs text-slate-500 italic",children:"Este turno ya fue consolidado y no puede ser modificado desde el planificador."}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2 justify-center",children:[(0,s.jsxs)("div",{className:"p-2 bg-white border rounded-lg text-center min-w-[60px]",children:[(0,s.jsx)("p",{className:"text-[9px] font-bold text-slate-400 uppercase",children:"Inicio"}),(0,s.jsx)("p",{className:"font-mono text-indigo-600 font-bold",children:formatTime(eX.currentShift.startTime)})]}),(0,s.jsxs)("div",{className:"p-2 bg-white border rounded-lg text-center min-w-[60px]",children:[(0,s.jsx)("p",{className:"text-[9px] font-bold text-slate-400 uppercase",children:"Fin"}),(0,s.jsx)("p",{className:"font-mono text-indigo-600 font-bold",children:formatTime(eX.currentShift.endTime||eX.currentShift.startTime)})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-slate-50 p-3 rounded-xl border border-slate-200 mb-4 space-y-3",children:[(0,s.jsxs)("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-1",children:[(0,s.jsx)(Z.Z,{size:10})," Gesti\xf3n de Horario y Ausencias"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("button",{onClick:()=>tB(e=>({...e,extend:!e.extend})),className:"p-2 rounded-lg text-xs font-bold border flex items-center justify-center gap-1 transition-all ".concat(tH.extend?"bg-violet-100 border-violet-300 text-violet-700 ring-1 ring-violet-400":"bg-white border-slate-200 text-slate-500"),children:[(0,s.jsx)(L,{size:14})," Extender Salida"]}),(0,s.jsxs)("button",{onClick:()=>tB(e=>({...e,early:!e.early})),className:"p-2 rounded-lg text-xs font-bold border flex items-center justify-center gap-1 transition-all ".concat(tH.early?"bg-cyan-100 border-cyan-300 text-cyan-700 ring-1 ring-cyan-400":"bg-white border-slate-200 text-slate-500"),children:[(0,s.jsx)(R,{size:14})," Adelantar Ingreso"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[9px] font-bold text-slate-400 uppercase mb-1 block",children:"Registro de Ausencia / Licencia"}),(0,s.jsxs)("div",{className:"flex gap-1 bg-white border rounded-lg p-1",children:[(0,s.jsx)("button",{onClick:()=>tB(e=>({...e,plannedNovedad:""})),className:"flex-1 py-1 rounded text-[10px] font-bold ".concat(tH.plannedNovedad?"text-slate-400 hover:bg-slate-50":"bg-slate-100 text-slate-700"),children:"Normal"}),(0,s.jsx)("button",{onClick:()=>tB(e=>({...e,plannedNovedad:"AVISO"})),className:"flex-1 py-1 rounded text-[10px] font-bold ".concat("AVISO"===tH.plannedNovedad?"bg-amber-100 text-amber-700":"text-slate-400 hover:bg-slate-50"),children:"Con Aviso"}),(0,s.jsx)("button",{onClick:()=>tB(e=>({...e,plannedNovedad:"LICENCIA"})),className:"flex-1 py-1 rounded text-[10px] font-bold ".concat("LICENCIA"===tH.plannedNovedad?"bg-purple-100 text-purple-700":"text-slate-400 hover:bg-slate-50"),children:"Licencia"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest border-b pb-1 flex items-center gap-2",children:"FT_SELECTION"===tl?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F,{size:12,className:"text-violet-500"})," Seleccione Turno para FT"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.Z,{size:10})," Acciones"]})}),eH.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-[10px] font-bold text-slate-500 uppercase",children:[(0,s.jsx)(U.Z,{size:10})," ",e.positionName]}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2",children:e.shifts.map(t=>(0,s.jsx)("button",{onClick:()=>handleAssignShift(t,e.positionName),className:"p-2 rounded-xl border flex flex-col items-center justify-center gap-1 hover:brightness-95 ".concat(getDefaultStyle(t.code)),children:(0,s.jsx)("span",{className:"font-black text-sm",children:t.code})},t.code))})]},t)),"NONE"===tl&&(0,s.jsx)("div",{className:"pt-2 border-t",children:(0,s.jsx)("button",{onClick:()=>handleAssignShift({code:"F",name:"Franco",startTime:"00:00"},"General"),className:"w-full p-3 rounded-xl border bg-emerald-50 border-emerald-200 text-emerald-700 font-black text-sm hover:brightness-95",children:"ASIGNAR FRANCO"})}),"NONE"!==tl&&(0,s.jsx)("button",{onClick:()=>tn("NONE"),className:"w-full py-3 bg-slate-100 text-slate-500 rounded-xl font-bold text-xs hover:bg-slate-200",children:"Volver / Cancelar"})]})]})]})]})}),e$&&(0,s.jsx)("div",{className:"fixed inset-0 z-[150] bg-amber-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:(0,s.jsx)("div",{className:"bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl border-2 border-amber-400 animate-in zoom-in-95",children:(0,s.jsxs)("div",{className:"flex flex-col items-center text-center space-y-4",children:[(0,s.jsx)("div",{className:"p-4 bg-amber-100 rounded-full text-amber-600",children:(0,s.jsx)(V.Z,{size:32})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-black text-lg text-amber-800 uppercase",children:"Advertencia Laboral"}),(0,s.jsx)("p",{className:"text-xs text-slate-600 mt-2 font-medium",children:e1})]}),(0,s.jsxs)("div",{className:"w-full pt-4 border-t flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>{e0(null),e2("")},className:"flex-1 py-3 text-slate-500 font-bold text-xs rounded-xl hover:bg-slate-100",children:"Cancelar"}),(0,s.jsx)("button",{onClick:()=>{e$&&(applyToPending({...e$.shiftConfig,isFrancoTrabajado:"FT_SELECTION"===tl,isExtended:tH.extend,isEarlyStart:tH.early,plannedNovedad:tH.plannedNovedad}),e0(null),e2(""))},className:"flex-1 py-3 bg-amber-500 text-white font-black text-xs rounded-xl hover:bg-amber-600 shadow-md",children:"Confirmar"})]})]})})}),tM&&eX&&(0,s.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-3xl p-6 shadow-2xl relative",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-6 border-b pb-4",children:[(0,s.jsx)("div",{className:"p-4 bg-rose-100 text-rose-600 rounded-2xl animate-pulse",children:(0,s.jsx)(p.Z,{size:32})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-black text-xl text-rose-700 uppercase",children:"Conflicto de Cobertura"}),(0,s.jsx)("p",{className:"text-sm font-bold text-slate-500",children:"Ausencia registrada sobre turno activo."})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-200",children:[(0,s.jsx)("p",{className:"text-[10px] font-black uppercase text-slate-400",children:"Ausencia"}),(0,s.jsx)("p",{className:"font-bold text-slate-800",children:(null===(ea=eX.absence)||void 0===ea?void 0:ea.type)||"Novedad"})]}),(0,s.jsxs)("div",{className:"p-4 bg-indigo-50 rounded-xl border border-indigo-200",children:[(0,s.jsx)("p",{className:"text-[10px] font-black uppercase text-indigo-400",children:"Turno Afectado"}),(0,s.jsx)("p",{className:"font-black text-2xl text-indigo-700",children:eX.currentShift.code})]})]}),(0,s.jsx)("h4",{className:"text-xs font-black uppercase text-slate-400 mb-3",children:"Opciones de Resoluci\xf3n"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("button",{onClick:()=>resolveConflict("SPLIT"),className:"w-full p-4 bg-white border-2 border-violet-100 hover:border-violet-500 rounded-xl flex items-center gap-4 group transition-all",children:[(0,s.jsx)("div",{className:"p-2 bg-violet-100 text-violet-600 rounded-lg group-hover:bg-violet-600 group-hover:text-white transition-colors",children:(0,s.jsx)(E,{size:20})}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"font-bold text-slate-700 text-sm",children:"Extender y Adelantar"}),(0,s.jsx)("p",{className:"text-[10px] text-slate-400",children:"Extiende salida del turno anterior y adelanta ingreso del posterior."})]})]}),(0,s.jsxs)("button",{onClick:()=>resolveConflict("FULL_COVERAGE"),className:"w-full p-4 bg-white border-2 border-emerald-100 hover:border-emerald-500 rounded-xl flex items-center gap-4 group transition-all",children:[(0,s.jsx)("div",{className:"p-2 bg-emerald-100 text-emerald-600 rounded-lg group-hover:bg-emerald-600 group-hover:text-white transition-colors",children:(0,s.jsx)(A.Z,{size:20})}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"font-bold text-slate-700 text-sm",children:"Asignar Suplente (Franco Trabajado)"}),(0,s.jsx)("p",{className:"text-[10px] text-slate-400",children:"Busca un guardia de franco para cubrir el turno completo."})]})]})]}),(0,s.jsx)("button",{onClick:()=>tO(!1),className:"w-full mt-6 py-3 text-slate-400 font-bold text-xs hover:text-slate-600",children:"Cancelar y resolver luego"})]})}),tF&&(0,s.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl relative",children:[(0,s.jsx)("button",{onClick:()=>tE(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:(0,s.jsx)(m.Z,{size:20})}),(0,s.jsxs)("h3",{className:"font-black text-lg text-slate-800 mb-1 flex items-center gap-2",children:[(0,s.jsx)(C.Z,{className:"text-amber-600"})," Carga de Ausencia (RRHH)"]}),(0,s.jsx)("p",{className:"text-xs text-slate-500 mb-4",children:"Simulaci\xf3n de carga de novedad por RRHH."}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Tipo de Ausencia"}),(0,s.jsxs)("select",{className:"w-full p-2 border rounded-lg text-sm font-bold bg-slate-50",value:tI.type,onChange:e=>tT({...tI,type:e.target.value}),children:[(0,s.jsx)("option",{value:"Ausencia con Aviso",children:"Ausencia con Aviso"}),(0,s.jsx)("option",{value:"Licencia M\xe9dica",children:"Licencia M\xe9dica"}),(0,s.jsx)("option",{value:"Vacaciones",children:"Vacaciones"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Motivo / Detalle"}),(0,s.jsx)("textarea",{className:"w-full p-2 border rounded-lg text-sm bg-slate-50 min-h-[80px]",placeholder:"Ej: Turno m\xe9dico, enfermedad...",value:tI.reason,onChange:e=>tT({...tI,reason:e.target.value})})]}),(0,s.jsx)("button",{onClick:handleRRHHSubmit,disabled:!eX,className:"w-full py-3 bg-amber-500 text-white font-black rounded-xl hover:bg-amber-600 disabled:opacity-50",children:"CONFIRMAR CARGA"})]})]})}),tL&&t_&&(0,s.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white w-full max-w-md rounded-3xl p-6 shadow-2xl relative flex flex-col max-h-[90vh]",children:[(0,s.jsx)("button",{onClick:()=>{tR(!1),tU(null)},className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:(0,s.jsx)(m.Z,{size:20})}),(0,s.jsxs)("div",{className:"flex items-center gap-3 border-b pb-4 mb-4",children:[(0,s.jsx)("div",{className:"p-3 bg-teal-100 text-teal-600 rounded-xl",children:(0,s.jsx)(P,{size:24})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-black text-lg text-slate-800",children:"Gesti\xf3n de Vacaciones"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Cubrir vacantes generadas por licencia"})]})]}),(0,s.jsx)("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-[10px] font-black uppercase text-slate-400",children:"Empleado"}),(0,s.jsx)("p",{className:"font-bold text-slate-800",children:t_.employeeName})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-[10px] font-black uppercase text-slate-400",children:"Periodo"}),(0,s.jsxs)("p",{className:"font-bold text-teal-600",children:[t_.startDate," ",(0,s.jsx)("br",{})," al ",t_.endDate]})]})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("label",{className:"text-xs font-black uppercase text-slate-500 block",children:"Seleccionar Suplente para el Periodo:"}),(0,s.jsxs)("select",{className:"w-full p-3 bg-white border-2 border-slate-200 rounded-xl text-sm font-bold focus:border-teal-500 outline-none",value:tV,onChange:e=>tP(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"-- Seleccionar Guardia --"}),ev.filter(e=>e.id!==t_.employeeId).map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("button",{onClick:()=>{if(!t_||!tV)return;let e=ev.find(e=>e.id===tV);if(!e)return;let t={...e4},[a,s,r]=t_.startDate.split("-").map(Number),[l,n,o]=t_.endDate.split("-").map(Number),i=new Date(a,s-1,r),d=new Date(l,n-1,o),c=0;for(;i<=d;){let a=getDateKey(i),s="".concat(t_.employeeId,"_").concat(a),r=ey[s];if(t[s]={code:"V",name:"Vacaciones",isTemp:!0,hours:0,startTime:"00:00",comments:"Licencia: ".concat(t_.type)},r&&"F"!==r.code){let s="".concat(e.id,"_").concat(a);t[s]={code:r.code,name:r.code,isTemp:!0,objectiveId:r.objectiveId,hours:r.hours||8,startTime:r.startTime,comments:"Cubriendo a ".concat(t_.employeeName," (").concat(t_.type,")")}}c++,i.setDate(i.getDate()+1)}e5(t),tR(!1),tU(null),q.Am.success("Cobertura planificada para ".concat(c," d\xedas. Revise y guarde los cambios."))},disabled:!tV,className:"w-full py-4 bg-teal-600 text-white rounded-xl font-black text-sm hover:bg-teal-700 shadow-lg shadow-teal-100 disabled:opacity-50 flex items-center justify-center gap-2",children:[(0,s.jsx)(H.Z,{size:18})," APLICAR COBERTURA"]})]})]})}),to&&(0,s.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white w-full max-w-md rounded-3xl p-6 shadow-2xl relative flex flex-col max-h-[90vh]",children:[(0,s.jsx)("button",{onClick:()=>{ti(!1),tc(null),tj(!1)},className:"absolute top-4 right-4 p-2 bg-slate-100 hover:bg-slate-200 rounded-full z-10",children:(0,s.jsx)(m.Z,{size:16})}),(0,s.jsxs)("div",{className:"flex items-center gap-3 border-b pb-4 mb-4 shrink-0",children:[(0,s.jsx)("div",{className:"p-3 bg-cyan-100 text-cyan-600 rounded-xl",children:(0,s.jsx)(E,{size:24})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-black text-lg text-slate-800",children:"Asistente de Intercambio"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Gesti\xf3n de Franco Compensatorio (FF)"})]})]}),tv?(0,s.jsxs)("div",{className:"space-y-6 flex-1 animate-in slide-in-from-right-4",children:[(0,s.jsxs)("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[(0,s.jsxs)("p",{className:"text-[10px] font-black uppercase text-slate-400 mb-2",children:["D\xeda 1 (",eX.dateStr,")"]}),(0,s.jsxs)("div",{className:"text-xs font-bold text-slate-700 mb-3",children:[(0,s.jsx)("span",{className:"text-cyan-600",children:null===(es=ev.find(e=>e.id===eX.empId))||void 0===es?void 0:es.name})," cubre a ",(0,s.jsx)("span",{className:"text-emerald-600",children:null===(er=ev.find(e=>e.id===tx))||void 0===er?void 0:er.name})]}),tS?(0,s.jsxs)("div",{className:"p-3 bg-white border border-cyan-200 rounded-lg text-center shadow-sm",children:[(0,s.jsx)("p",{className:"text-[10px] text-cyan-600 font-bold mb-1",children:"TURNO DETECTADO"}),(0,s.jsx)("p",{className:"text-2xl font-black text-slate-800",children:ty})]}):(0,s.jsx)("div",{className:"flex gap-2 justify-center",children:["M","T","N"].map(e=>(0,s.jsx)("button",{onClick:()=>tN(e),className:"w-10 h-10 rounded-lg font-black ".concat(ty===e?"bg-cyan-600 text-white ring-2 ring-cyan-300":"bg-white border text-slate-500"),children:e},e))})]}),(0,s.jsxs)("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[(0,s.jsxs)("p",{className:"text-[10px] font-black uppercase text-slate-400 mb-2",children:["D\xeda 2 (",tp,")"]}),(0,s.jsxs)("div",{className:"text-xs font-bold text-slate-700 mb-3",children:[(0,s.jsx)("span",{className:"text-emerald-600",children:null===(el=ev.find(e=>e.id===tx))||void 0===el?void 0:el.name})," cubre a ",(0,s.jsx)("span",{className:"text-cyan-600",children:null===(en=ev.find(e=>e.id===eX.empId))||void 0===en?void 0:en.name})]}),tC?(0,s.jsxs)("div",{className:"p-3 bg-white border border-cyan-200 rounded-lg text-center shadow-sm",children:[(0,s.jsx)("p",{className:"text-[10px] text-cyan-600 font-bold mb-1",children:"TURNO DETECTADO"}),(0,s.jsx)("p",{className:"text-2xl font-black text-slate-800",children:tw})]}):(0,s.jsx)("div",{className:"flex gap-2 justify-center",children:["M","T","N"].map(e=>(0,s.jsx)("button",{onClick:()=>tk(e),className:"w-10 h-10 rounded-lg font-black ".concat(tw===e?"bg-cyan-600 text-white ring-2 ring-cyan-300":"bg-white border text-slate-500"),children:e},e))})]}),(0,s.jsxs)("button",{onClick:()=>{var e,t;let a=eX.empId,s=eX.dateStr,r={...e4},l=(null===(e=ev.find(e=>e.id===a))||void 0===e?void 0:e.name)||"Emp1",n=(null===(t=ev.find(e=>e.id===tx))||void 0===t?void 0:t.name)||"Emp2";r["".concat(a,"_").concat(s)]={code:ty,isTemp:!0,isFranco:!1,isSwap:!0,swapWith:n},r["".concat(tx,"_").concat(s)]={code:"FF",isTemp:!0,isFranco:!0,isFrancoCompensatorio:!0,swapWith:l,swapDate:tp},r["".concat(a,"_").concat(tp)]={code:"FF",isTemp:!0,isFranco:!0,isFrancoCompensatorio:!0,swapWith:n,swapDate:s},r["".concat(tx,"_").concat(tp)]={code:tw,isTemp:!0,isFranco:!1,isSwap:!0,swapWith:l},e5(r),ti(!1),tc(null),eQ(null),tj(!1),q.Am.success("Enroque completado")},className:"w-full py-4 bg-emerald-600 text-white rounded-xl font-black text-sm hover:bg-emerald-700 shadow-lg shadow-emerald-200 flex items-center justify-center gap-2",children:[(0,s.jsx)(H.Z,{size:18})," CONFIRMAR ENROQUE"]}),(0,s.jsx)("button",{onClick:()=>tj(!1),className:"w-full py-2 text-slate-400 text-xs font-bold hover:text-slate-600",children:"Volver atr\xe1s"})]}):(0,s.jsxs)("div",{className:"space-y-4 flex-1 overflow-y-auto custom-scrollbar p-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 mb-1 block",children:"1. \xbfCon qui\xe9n cambia?"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(B.Z,{size:14,className:"absolute left-3 top-3.5 text-slate-400"}),(0,s.jsx)("input",{autoFocus:!0,type:"text",placeholder:"Buscar compa\xf1ero...",className:"w-full pl-9 pr-4 py-3 bg-slate-50 border rounded-xl text-sm font-bold outline-none focus:ring-2 focus:ring-cyan-500 transition-all",value:th,onChange:e=>tb(e.target.value)})]}),(0,s.jsx)("div",{className:"mt-2 max-h-40 overflow-y-auto custom-scrollbar border rounded-xl bg-white shadow-sm",children:tG.length>0?tG.map(e=>(0,s.jsxs)("div",{onClick:()=>tm(e.id),className:"p-3 flex justify-between items-center cursor-pointer border-b last:border-0 hover:bg-cyan-50 transition-colors ".concat(tx===e.id?"bg-cyan-50 border-cyan-200":""),children:[(0,s.jsx)("span",{className:"text-xs font-bold ".concat(tx===e.id?"text-cyan-700":"text-slate-600"),children:e.name}),tx===e.id&&(0,s.jsx)(H.Z,{size:14,className:"text-cyan-600"})]},e.id)):(0,s.jsx)("div",{className:"p-4 text-center text-xs text-slate-400 italic",children:"No se encontraron empleados."})})]}),tx&&(0,s.jsxs)("div",{className:"animate-in slide-in-from-top-2 pt-2 border-t",children:[(0,s.jsx)("label",{className:"text-[10px] font-black uppercase text-slate-400 mb-2 block",children:"2. Seleccione el Franco del compa\xf1ero:"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2 max-h-32 overflow-y-auto",children:tf.length>0?tf.map(e=>(0,s.jsx)("button",{onClick:()=>handleSelectDate(e.dateStr),className:"p-2 bg-emerald-50 border border-emerald-100 text-emerald-700 rounded-lg text-xs font-black hover:bg-emerald-100 flex flex-col items-center",children:(0,s.jsx)("span",{children:e.label})},e.dateStr)):(0,s.jsxs)("div",{className:"col-span-3 p-3 bg-slate-50 text-slate-400 text-xs italic rounded-xl flex items-center justify-center gap-2",children:[(0,s.jsx)(O,{size:14})," Sin francos disponibles."]})})]})]})]})}),e9&&(0,s.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white w-full max-w-md rounded-2xl p-6 shadow-2xl relative",children:[(0,s.jsx)("button",{onClick:()=>te(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:(0,s.jsx)(m.Z,{size:20})}),(0,s.jsxs)("h3",{className:"font-black text-lg text-slate-800 mb-4 flex items-center gap-2",children:[(0,s.jsx)(y,{className:"text-indigo-600"})," Historial de Cambios"]}),(0,s.jsx)("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar space-y-3",children:tt.length>0?tt.map(e=>(0,s.jsxs)("div",{onClick:()=>handleViewSnapshot(e),className:"p-4 border rounded-xl hover:bg-indigo-50 cursor-pointer group transition-all",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"font-bold text-indigo-700 text-xs bg-indigo-100 px-2 py-1 rounded",children:new Date(1e3*e.timestamp.seconds).toLocaleString()}),(0,s.jsxs)("span",{className:"text-[10px] text-slate-400",children:["Por: ",e.user]})]}),(0,s.jsxs)("p",{className:"text-xs text-slate-600",children:["Se guardaron ",(0,s.jsx)("strong",{children:e.count})," cambios."]}),(0,s.jsxs)("div",{className:"text-[10px] text-indigo-500 font-bold mt-2 opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1",children:[(0,s.jsx)(u,{size:12})," Comparar con Actual"]})]},e.id)):(0,s.jsx)("div",{className:"text-center py-8 text-slate-400 text-xs italic",children:"No hay historial disponible para este mes."})})]})}),eJ&&(0,s.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white w-full max-w-md rounded-2xl p-6 shadow-2xl relative",children:[(0,s.jsx)("button",{onClick:()=>eK(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:(0,s.jsx)(m.Z,{size:20})}),(0,s.jsxs)("h3",{className:"font-black text-lg text-slate-800 mb-1 flex items-center gap-2",children:[(0,s.jsx)(A.Z,{className:"text-emerald-600"})," Asignar Empleado"]}),(0,s.jsx)("p",{className:"text-xs text-slate-500 mb-4",children:"Busque un empleado para traerlo a la vista actual."}),(0,s.jsxs)("div",{className:"relative mb-4",children:[(0,s.jsx)(B.Z,{className:"absolute left-3 top-3 text-slate-400",size:16}),(0,s.jsx)("input",{autoFocus:!0,type:"text",placeholder:"Buscar por nombre o legajo...",className:"w-full pl-10 pr-4 py-3 bg-slate-50 border rounded-xl text-sm font-bold outline-none focus:ring-2 focus:ring-emerald-500",value:eq,onChange:e=>eY(e.target.value)})]}),(0,s.jsxs)("div",{className:"max-h-[50vh] overflow-y-auto custom-scrollbar space-y-2",children:[ev.filter(e=>e.name.toLowerCase().includes(eq.toLowerCase())).slice(0,10).map(e=>(0,s.jsxs)("div",{onClick:()=>{let t=tJ[0],a="".concat(e.id,"_").concat(getDateKey(t)),s={...e4};s[a]?q.Am.info("Este empleado ya tiene cambios pendientes."):(s[a]={code:"M",isTemp:!0,hours:8},e5(s),q.Am.success("".concat(e.name," agregado a la vista.")),eK(!1))},className:"p-3 border rounded-xl hover:bg-emerald-50 cursor-pointer flex justify-between items-center group transition-all",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold text-slate-700 text-sm",children:e.name}),(0,s.jsx)("p",{className:"text-[10px] text-slate-400",children:e.laborAgreement||"Sin Convenio"})]}),(0,s.jsx)(J.Z,{size:18,className:"text-emerald-500 opacity-0 group-hover:opacity-100 transition-opacity"})]},e.id)),eq&&0===ev.filter(e=>e.name.toLowerCase().includes(eq.toLowerCase())).length&&(0,s.jsx)("div",{className:"text-center py-4 text-slate-400 text-xs",children:"No se encontraron empleados."})]})]})}),(0,s.jsxs)("div",{className:"bg-white p-2 rounded-xl border shadow-sm shrink-0 h-32 overflow-hidden flex flex-col no-print",children:[(0,s.jsxs)("h4",{className:"text-[10px] font-black uppercase text-slate-400 mb-2 px-2 border-b pb-1 flex items-center gap-2",children:[(0,s.jsx)(z.Z,{size:12})," Actividad Reciente"]}),(0,s.jsx)("div",{className:"overflow-y-auto custom-scrollbar space-y-1 px-2 pb-2",children:eF.map(e=>{let t=eV[e.actor]||eV[e.actorUid]||e.actor||"Sistema";return(0,s.jsxs)("div",{className:"flex items-center gap-2 text-[10px] p-1 border-b last:border-0 hover:bg-slate-50",children:[(0,s.jsx)("span",{className:"font-mono text-slate-400",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),(0,s.jsx)("span",{className:"font-bold px-1.5 rounded uppercase bg-slate-100 text-slate-600",children:e.label}),(0,s.jsx)("span",{className:"text-slate-600 truncate flex-1",children:e.detail}),(0,s.jsx)("span",{className:"text-[9px] text-slate-400 font-bold",children:t})]},e.id)})})]})]})]})}}},function(e){e.O(0,[761,897,963,712,354,685,774,888,179],function(){return e(e.s=75646)}),_N_E=e.O()}]);