(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[476],{98814:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(84297);let n=(0,s.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},64998:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(84297);let n=(0,s.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},73696:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(84297);let n=(0,s.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},25205:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(84297);let n=(0,s.Z)("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},13718:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(84297);let n=(0,s.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},41830:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(84297);let n=(0,s.Z)("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]])},70429:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/planificacion/index_backup_v3",function(){return a(3384)}])},43475:function(e,t,a){"use strict";a.d(t,{Z:function(){return DashboardLayout}});var s=a(85893),n=a(67294),r=a(41664),i=a.n(r),l=a(11163),o=a(41503),c=a(28477),d=a(85876),u=a(64712),m=a(54463),x=a(41352),h=a(39483),p=a(72367),f=a(34622),b=a(28909),g=a(81629),j=a(49525),v=a(71408),N=a(78051),y=a(77232);function DashboardLayout(e){let{children:t}=e,[a,r]=(0,n.useState)(!0),w=(0,l.useRouter)(),{user:k}=(0,o.a)(),handleLogout=async()=>{try{await (0,d.w7)(c.I8),window.location.href="/login"}catch(e){console.error("Error cerrando sesi\xf3n:",e)}},isActive=e=>w.pathname.startsWith(e),getLinkClass=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s="flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium text-sm ".concat(a?"":"justify-center px-2");return isActive(e)?"".concat(s," bg-indigo-600 text-white shadow-lg shadow-indigo-900/50"):t?"".concat(s," bg-rose-600/10 text-rose-400 hover:bg-rose-600 hover:text-white border border-rose-900/50 hover:border-rose-500"):"".concat(s," text-slate-300 hover:bg-slate-800 hover:text-white")};return(0,s.jsxs)("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 flex",children:[(0,s.jsx)(u.x7,{position:"top-right",richColors:!0,closeButton:!0,expand:!0}),(0,s.jsxs)("aside",{className:"fixed top-0 left-0 z-40 h-screen transition-all duration-300 bg-slate-900 text-white border-r border-slate-800 flex flex-col\n        ".concat(a?"w-64 translate-x-0":"w-20 -translate-x-full lg:translate-x-0"," \n        "),children:[(0,s.jsxs)("div",{className:"p-6 flex items-center ".concat(a?"justify-between":"justify-center"," shrink-0"),children:[a?(0,s.jsx)("span",{className:"text-xl font-black tracking-tighter text-indigo-400",children:"CRONOAPP"}):(0,s.jsx)(m.Z,{className:"text-indigo-400"}),(0,s.jsx)("button",{onClick:()=>r(!1),className:"lg:hidden text-slate-400 hover:text-white",children:(0,s.jsx)(x.Z,{})})]}),(0,s.jsxs)("nav",{className:"px-3 space-y-2 mt-4 flex-1 overflow-y-auto custom-scrollbar",children:[a&&(0,s.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Operativa"}),(0,s.jsxs)(i(),{href:"/admin/dashboard",className:getLinkClass("/admin/dashboard"),title:"Dashboard",children:[(0,s.jsx)(h.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Dashboard"})]}),(0,s.jsxs)(i(),{href:"/admin/operaciones",className:getLinkClass("/admin/operaciones",!0),title:"Centro Control",children:[(0,s.jsx)(p.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Centro Control"})]}),(0,s.jsxs)(i(),{href:"/admin/planificacion",className:getLinkClass("/admin/planificacion"),title:"Planificador",children:[(0,s.jsx)(f.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Planificador"})]}),a&&(0,s.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest mt-4",children:"Gesti\xf3n"}),(0,s.jsxs)(i(),{href:"/admin/crm",className:getLinkClass("/admin/crm"),title:"CRM Clientes",children:[(0,s.jsx)(b.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"CRM Clientes"})]}),(0,s.jsxs)(i(),{href:"/admin/servicios",className:getLinkClass("/admin/servicios"),title:"Servicios",children:[(0,s.jsx)(m.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Servicios"})]}),(0,s.jsxs)(i(),{href:"/admin/reportes",className:getLinkClass("/admin/reportes"),title:"Reportes",children:[(0,s.jsx)(g.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Reportes"})]}),(0,s.jsxs)(i(),{href:"/admin/rrhh",className:getLinkClass("/admin/rrhh"),title:"RRHH",children:[(0,s.jsx)(j.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"RRHH"})]}),a&&(0,s.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest mt-4",children:"Sistema"}),(0,s.jsxs)(i(),{href:"/admin/configuracion",className:getLinkClass("/admin/configuracion"),title:"Configuraci\xf3n",children:[(0,s.jsx)(v.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Configuraci\xf3n"})]})]}),(0,s.jsx)("div",{className:"p-4 border-t border-slate-800 shrink-0 flex flex-col gap-2",children:(0,s.jsxs)("button",{onClick:handleLogout,className:"w-full flex items-center justify-center gap-3 px-4 py-3 text-rose-400 hover:bg-rose-900/20 hover:text-rose-300 rounded-xl transition-all font-medium text-sm",title:"Cerrar Sesi\xf3n",children:[(0,s.jsx)(N.Z,{size:20})," ",a&&(0,s.jsx)("span",{children:"Salir"})]})})]}),(0,s.jsxs)("div",{className:"flex-1 transition-all duration-300 ".concat(a?"lg:ml-64":"lg:ml-20"),children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 p-4 shadow-sm border-b border-slate-200 dark:border-slate-700 flex items-center gap-4 sticky top-0 z-30",children:[(0,s.jsx)("button",{onClick:()=>r(!a),className:"p-2 rounded-lg hover:bg-slate-100 text-slate-600 dark:text-slate-200 transition-colors",children:(0,s.jsx)(y.Z,{size:24})}),(0,s.jsx)("span",{className:"font-black text-slate-700 dark:text-white uppercase tracking-tight",children:a?"Panel de Control":"CronoApp"})]}),(0,s.jsx)("main",{className:"p-4 lg:p-8",children:t})]})]})}},41503:function(e,t,a){"use strict";a.d(t,{a:function(){return useAuth}}),a(85893);var s=a(67294);a(85876),a(28477),a(11163);let n=(0,s.createContext)({user:null,loading:!0,logout:async()=>{}}),useAuth=()=>(0,s.useContext)(n)},28477:function(e,t,a){"use strict";a.d(t,{I8:function(){return o},db:function(){return c},wk:function(){return d}});var s=a(83977),n=a(85876),r=a(93504),i=a(23914);let l=(0,s.C6)().length?(0,s.Mq)():(0,s.ZF)({apiKey:"AIzaSyBJaTiMekwbGPXAm-mkPl_u6KEWCSpvfic",authDomain:"comtroldata.firebaseapp.com",projectId:"comtroldata",storageBucket:"comtroldata.firebasestorage.app",messagingSenderId:"698108879063",appId:"1:698108879063:web:ab30eb8b80a774f52f1092"}),o=(0,n.v0)(l),c=(0,r.ad)(l),d=(0,i.$C)(l)},3384:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return PlanificacionPage}});var s=a(85893),n=a(67294),r=a(9008),i=a.n(r),l=a(43475),o=a(41830),c=a(73696),d=a(98814),u=a(64998),m=a(13718),x=a(41352),h=a(25205),p=a(49525),f=a(28477),b=a(85876),g=a(93504),j=a(64712);let v={M:"bg-blue-100 text-blue-700 border-blue-200",T:"bg-orange-100 text-orange-700 border-orange-200",N:"bg-indigo-100 text-indigo-700 border-indigo-200",D12:"bg-cyan-100 text-cyan-700 border-cyan-200",N12:"bg-purple-100 text-purple-700 border-purple-200",F:"bg-emerald-100 text-emerald-700 border-emerald-200",PU:"bg-pink-100 text-pink-700 border-pink-200",A:"bg-red-100 text-red-700 border-red-300 font-black pattern-diagonal",V:"bg-teal-100 text-teal-700 border-teal-300 font-black",L:"bg-purple-100 text-purple-700 border-purple-300 font-black",E:"bg-rose-100 text-rose-700 border-rose-300 font-black","Ausencia con Aviso":"bg-amber-100 text-amber-700 border-amber-300"},getAbsenceCode=e=>{if(!e)return"A";let t=e.toLowerCase();return t.includes("vacaci")?"V":t.includes("licencia")?"L":t.includes("enfermedad")||t.includes("medico")?"E":t.includes("ausencia")||t.includes("falta")||t.includes("aviso")?"A":e.substring(0,1).toUpperCase()},getDateKey=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s)},getDefaultStyle=e=>v[e]||"bg-slate-100 text-slate-700 border-slate-300",N={MANUAL_CHECKIN:"Presente Manual",ASIGNACION_TURNO:"Asignaci\xf3n",ASIGNACION:"Asignaci\xf3n",ELIMINACION_TURNO:"Eliminaci\xf3n",ELIMINACION:"Eliminaci\xf3n",AUTORIZACION_EXCEPCION:"Excepci\xf3n Autorizada",DESVINCULACION_OBJETIVO:"Desvinculaci\xf3n Objetivo"};function PlanificacionPage(){var e,t;let[a,r]=(0,n.useState)(new Date),[y,w]=(0,n.useState)(""),[k,C]=(0,n.useState)(""),[D,S]=(0,n.useState)(!1),[A,I]=(0,n.useState)(!1),[E,M]=(0,n.useState)([]),[T,_]=(0,n.useState)({}),[O,Z]=(0,n.useState)({}),[L,z]=(0,n.useState)([]),[R,P]=(0,n.useState)([]),[U,J]=(0,n.useState)([]),[K,F]=(0,n.useState)([]),[H,B]=(0,n.useState)(!1),[V,G]=(0,n.useState)(!1),[X,Y]=(0,n.useState)(null),[q,W]=(0,n.useState)("Cargando..."),[$,Q]=(0,n.useState)({}),[ee,et]=(0,n.useState)([]),[ea,es]=(0,n.useState)(!1),[en,er]=(0,n.useState)(""),[ei,el]=(0,n.useState)(""),[eo,ec]=(0,n.useState)(null),[ed,eu]=(0,n.useState)(null),[em,ex]=(0,n.useState)(""),[eh,ep]=(0,n.useState)({}),[ef,eb]=(0,n.useState)({start:null,end:null}),[eg,ej]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let loadUsers=async()=>{try{let e=await (0,g.PL)((0,g.hJ)(f.db,"system_users")),t={};e.docs.forEach(e=>{let a=e.data();a.email&&(t[a.email]=a.name||(a.firstName?"".concat(a.firstName," ").concat(a.lastName||""):a.email))}),Q(t)}catch(e){console.error(e)}};loadUsers();let e=(0,b.v0)(),t=(0,b.Aj)(e,e=>{e?W(e.displayName||e.email||"Usuario Desconocido"):W("No Logueado")});return()=>t()},[]),(0,n.useEffect)(()=>{let e=(0,g.cf)((0,g.hJ)(f.db,"clients"),e=>z(e.docs.map(e=>({id:e.id,...e.data()})))),t=(0,g.cf)((0,g.hJ)(f.db,"convenios"),e=>P(e.docs.map(e=>({id:e.id,...e.data()})))),a=(0,g.cf)((0,g.hJ)(f.db,"empleados"),e=>M(e.docs.map(e=>({id:e.id,name:e.data().name||e.data().firstName+" "+e.data().lastName,preferredObjectiveId:e.data().preferredObjectiveId,laborAgreement:e.data().laborAgreement})))),s=(0,g.cf)((0,g.hJ)(f.db,"turnos"),e=>{let t={};e.docs.forEach(e=>{var a;let s=e.data();if(null===(a=s.startTime)||void 0===a?void 0:a.seconds){let a=new Date(1e3*s.startTime.seconds),n="".concat(s.employeeId,"_").concat(getDateKey(a));t[n]={id:e.id,...s,code:s.code||s.type}}}),_(t)}),n=(0,g.cf)((0,g.hJ)(f.db,"ausencias"),e=>{let t={};e.docs.forEach(e=>{let a=e.data();if(a.startDate&&a.endDate&&a.employeeId){let[s,n,r]=a.startDate.split("-").map(Number),[i,l,o]=a.endDate.split("-").map(Number),c=new Date(s,n-1,r),d=new Date(i,l-1,o);for(;c<=d;){let s="".concat(a.employeeId,"_").concat(getDateKey(c));t[s]={id:e.id,type:a.type||"Ausencia",reason:a.reason,status:a.status,isAbsence:!0},c.setDate(c.getDate()+1)}}}),Z(t)});return()=>{e(),a(),s(),n(),t()}},[]),(0,n.useEffect)(()=>{let e=(0,g.IO)((0,g.hJ)(f.db,"audit_logs"),(0,g.Xo)("timestamp","desc"),(0,g.b9)(30)),t=(0,g.IO)((0,g.hJ)(f.db,"ausencias"),(0,g.b9)(20)),a=(0,g.cf)(e,e=>{let a=e.docs.map(e=>{var t;return{id:e.id,source:"AUDIT",timestamp:(null===(t=e.data().timestamp)||void 0===t?void 0:t.seconds)*1e3,label:N[e.data().action]||e.data().action,detail:e.data().details,actor:e.data().actorName}});(0,g.PL)(t).then(e=>{let t=e.docs.map(e=>({id:e.id,source:"AUSENCIA",timestamp:new Date(e.data().createdAt||e.data().startDate).getTime(),label:e.data().type||"Ausencia",detail:"".concat(e.data().employeeName,": ").concat(e.data().reason),actor:"RRHH",critical:!0})),s=[...a,...t].sort((e,t)=>t.timestamp-e.timestamp).slice(0,50);J(s)})});return()=>a()},[]),(0,n.useEffect)(()=>{let e=new Date().toISOString().split("T")[0],t=(0,g.IO)((0,g.hJ)(f.db,"ausencias"),(0,g.ar)("startDate",">=",e)),a=(0,g.cf)(t,e=>{let t=e.docs.map(e=>({...e.data(),id:e.id})).filter(e=>!e.viewed).map(e=>({id:e.id,title:e.type,msg:"".concat(e.employeeName," - ").concat(e.reason),date:e.startDate,employeeId:e.employeeId,critical:!0}));F(t),t.length>0&&G(!0)});return()=>a()},[]),(0,n.useEffect)(()=>{if(!y||!k){et([]);return}let fetchSLA=async()=>{try{let e=(0,g.IO)((0,g.hJ)(f.db,"servicios_sla"),(0,g.ar)("clientId","==",y)),t=await (0,g.PL)(e),a=t.docs.map(e=>e.data()).find(e=>e.objectiveId===k),s=[];a&&a.positions&&a.positions.forEach(e=>{e.allowedShiftTypes&&e.allowedShiftTypes.length>0&&s.push({positionName:e.name||"General",shifts:e.allowedShiftTypes.map(e=>({code:e.code,name:e.name,startTime:e.startTime,endTime:e.endTime,hours:e.hours}))})}),0===s.length&&s.push({positionName:"General",shifts:[{code:"M",name:"M",startTime:"06:00",hours:8},{code:"T",name:"T",startTime:"14:00",hours:8},{code:"N",name:"N",startTime:"22:00",hours:8}]}),et(s)}catch(e){et([])}};fetchSLA()},[y,k]);let ev=(0,n.useMemo)(()=>{let e=a.getFullYear(),t=a.getMonth(),s=new Date(e,t,1),n=[];for(;s.getMonth()===t;)n.push(new Date(s)),s.setDate(s.getDate()+1);return n},[a]),eN=(0,n.useMemo)(()=>{if(!k&&!D)return[];let e=E;return k&&!D&&(e=e.filter(e=>e.preferredObjectiveId===k)),en&&(e=e.filter(e=>e.name.toLowerCase().includes(en.toLowerCase()))),e.sort((e,t)=>{let a=ev.some(t=>T["".concat(e.id,"_").concat(getDateKey(t))]||O["".concat(e.id,"_").concat(getDateKey(t))]),s=ev.some(e=>T["".concat(t.id,"_").concat(getDateKey(e))]||O["".concat(t.id,"_").concat(getDateKey(e))]);return a&&!s?-1:!a&&s?1:e.name.localeCompare(t.name)})},[E,k,D,en,T,O,ev]);(0,n.useMemo)(()=>E.filter(e=>e.preferredObjectiveId!==k&&e.name.toLowerCase().includes(ei.toLowerCase())),[E,k,ei]);let handleMouseDown=e=>{k&&(ej(!0),eb({start:e,end:e}))},handleMouseEnter=e=>{eg&&eb(t=>({...t,end:e}))},isCellSelected=(e,t)=>{if(!ef.start||!ef.end)return!1;let[a,s]=ef.start.split("_"),[n,r]=ef.end.split("_"),i=getDateKey(t);return e===a&&e===n&&i>=(s<r?s:r)&&i<=(s>r?s:r)||ef.start==="".concat(e,"_").concat(getDateKey(t))},applyBulkChange=e=>{if(!ef.start||!ef.end)return;let[t,a]=ef.start.split("_"),[s,n]=ef.end.split("_");if(t!==s){j.Am.error("Por seguridad, la edici\xf3n masiva solo est\xe1 permitida para un mismo empleado a la vez.");return}let r=new Date(a),i=new Date(n),l=r>i?r:i,o={...eh};for(let a=new Date(r<i?r:i);a<=l;a.setDate(a.getDate()+1)){let s="".concat(t,"_").concat(getDateKey(a));null===e?o[s]={isDeleted:!0}:o[s]={...e,isTemp:!0}}ep(o),eb({start:null,end:null}),j.Am.info("Cambios en borrador. Recuerda GUARDAR.")},handleCommitChanges=async()=>{if(0===Object.keys(eh).length||!confirm("\xbfConfirmar y guardar ".concat(Object.keys(eh).length," cambios en la base de datos?")))return;I(!0);let e=(0,g.qs)(f.db),t=[];try{for(let[a,s]of Object.entries(eh)){let[n,r]=a.split("_"),i=T[a];if(s.isDeleted)(null==i?void 0:i.id)&&(e.delete((0,g.JU)(f.db,"turnos",i.id)),t.push({type:"DELETE",empId:n,date:r}));else{if(i&&i.code===s.code)continue;(null==i?void 0:i.id)&&e.delete((0,g.JU)(f.db,"turnos",i.id));let[a,l,o]=r.split("-").map(Number),c=new Date(a,l-1,o),[d,u]=(s.startTime||"06:00").split(":").map(Number),m=new Date(c);m.setHours(d,u||0,0);let x=new Date(m);"F"===s.code?x.setHours(23,59,59):x.setTime(m.getTime()+36e5*(s.hours||8));let h=(0,g.JU)((0,g.hJ)(f.db,"turnos"));e.set(h,{employeeId:n,clientId:y,objectiveId:k,code:s.code,type:s.name,startTime:g.EK.fromDate(m),endTime:g.EK.fromDate(x),isFranco:"F"===s.code,createdAt:(0,g.Bt)(),comments:"Carga Masiva (Planificador)"}),t.push({type:"CREATE",empId:n,date:r,code:s.code})}}if(t.length>0){var s;let e=(0,b.v0)(),n=(null===(s=e.currentUser)||void 0===s?void 0:s.email)||"Sistema";await (0,g.ET)((0,g.hJ)(f.db,"planificaciones_historial"),{timestamp:(0,g.Bt)(),user:n,period:"".concat(a.getMonth()+1,"-").concat(a.getFullYear()),changeCount:t.length,changes:t})}await e.commit(),ep({}),j.Am.success("Planificaci\xf3n guardada exitosamente")}catch(e){console.error(e),j.Am.error("Error al guardar cambios")}finally{I(!1)}};return(0,s.jsxs)(l.Z,{children:[(0,s.jsx)(i(),{children:(0,s.jsx)("title",{children:"Planificador V2"})}),(0,s.jsx)(j.x7,{position:"top-center"}),(0,s.jsxs)("div",{className:"flex flex-col h-[calc(100vh-100px)] p-2 space-y-4 animate-in fade-in",onMouseUp:()=>{ej(!1)},children:[(0,s.jsxs)("div",{className:"bg-white p-3 rounded-2xl shadow-sm border flex flex-wrap items-center gap-3 shrink-0 justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("select",{value:y,onChange:e=>{w(e.target.value),C(""),er(""),S(!1)},className:"bg-slate-50 border p-2 rounded-xl text-xs font-bold w-40 outline-none",children:[(0,s.jsx)("option",{value:"",children:"Cliente..."}),L.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("select",{value:k,onChange:e=>{C(e.target.value),er(""),S(!1)},className:"bg-slate-50 border p-2 rounded-xl text-xs font-bold w-40 outline-none",disabled:!y,children:[(0,s.jsx)("option",{value:"",children:"Objetivo..."}),null===(t=L.find(e=>e.id===y))||void 0===t?void 0:null===(e=t.objetivos)||void 0===e?void 0:e.map(e=>(0,s.jsx)("option",{value:e.id||e.name,children:e.name},e.id||e.name))]})]}),Object.keys(eh).length>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2 animate-in slide-in-from-top-2 bg-amber-50 p-1 rounded-xl border border-amber-200",children:[(0,s.jsxs)("span",{className:"text-[10px] font-black text-amber-700 px-2",children:[Object.keys(eh).length," cambios sin guardar"]}),(0,s.jsx)("button",{onClick:()=>{confirm("\xbfDescartar todos los cambios no guardados?")&&ep({})},className:"p-2 hover:bg-amber-100 rounded-lg text-amber-600",children:(0,s.jsx)(o.Z,{size:16})}),(0,s.jsxs)("button",{onClick:handleCommitChanges,className:"bg-amber-500 hover:bg-amber-600 text-white px-4 py-1.5 rounded-lg text-xs font-black flex items-center gap-2 shadow-md",children:[(0,s.jsx)(c.Z,{size:14})," GUARDAR TODO"]})]}),(0,s.jsxs)("div",{className:"flex items-center bg-slate-100 rounded-xl p-1",children:[(0,s.jsx)("button",{onClick:()=>r(new Date(a.getFullYear(),a.getMonth()-1,1)),className:"p-1",children:(0,s.jsx)(d.Z,{size:16})}),(0,s.jsx)("span",{className:"px-3 font-black text-xs w-24 text-center capitalize",children:a.toLocaleDateString("es-AR",{month:"long"})}),(0,s.jsx)("button",{onClick:()=>r(new Date(a.getFullYear(),a.getMonth()+1,1)),className:"p-1",children:(0,s.jsx)(u.Z,{size:16})})]})]}),ef.start&&(0,s.jsxs)("div",{className:"absolute top-20 left-1/2 -translate-x-1/2 z-[60] bg-slate-800 text-white p-2 rounded-2xl shadow-2xl flex gap-2 animate-in zoom-in-95 items-center",children:[(0,s.jsx)("span",{className:"text-[10px] font-bold px-2",children:"Asignar a selecci\xf3n:"}),["M","T","N","F"].map(e=>(0,s.jsx)("button",{onClick:()=>applyBulkChange({code:e,name:"F"===e?"Franco":"Turno",hours:"F"===e?0:8}),className:"w-8 h-8 rounded-lg bg-slate-700 hover:bg-indigo-600 font-black text-xs transition-colors",children:e},e)),(0,s.jsx)("div",{className:"w-px h-6 bg-slate-600 mx-1"}),(0,s.jsx)("button",{onClick:()=>applyBulkChange(null),className:"p-2 hover:bg-rose-600 rounded-lg text-rose-300 hover:text-white transition-colors",children:(0,s.jsx)(m.Z,{size:16})}),(0,s.jsx)("button",{onClick:()=>eb({start:null,end:null}),className:"ml-2",children:(0,s.jsx)(x.Z,{size:16})})]}),k||D?(0,s.jsx)("div",{className:"flex-1 bg-white rounded-2xl border shadow-xl overflow-hidden flex flex-col relative select-none",children:(0,s.jsx)("div",{className:"flex-1 overflow-auto custom-scrollbar",children:(0,s.jsxs)("table",{className:"border-collapse w-full",children:[(0,s.jsx)("thead",{className:"sticky top-0 z-30 bg-slate-100 shadow-md h-10",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"sticky left-0 z-40 bg-slate-100 p-2 text-left min-w-[200px] border-b border-r",children:(0,s.jsxs)("span",{className:"text-[10px] font-black uppercase flex items-center gap-2",children:[(0,s.jsx)(p.Z,{size:12})," Dotaci\xf3n (",eN.length,")"]})}),ev.map(e=>(0,s.jsx)("th",{className:"min-w-[36px] border-b border-r p-1 text-center ".concat([0,6].includes(e.getDay())?"bg-slate-200":""),children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-[8px] font-black uppercase text-slate-500",children:e.toLocaleDateString("es-AR",{weekday:"narrow"})}),(0,s.jsx)("span",{className:"text-[10px] font-bold",children:e.getDate()})]})},e.toISOString()))]})}),(0,s.jsx)("tbody",{children:eN.map(e=>(0,s.jsxs)("tr",{className:"group hover:bg-slate-50",children:[(0,s.jsx)("td",{className:"sticky left-0 z-20 bg-white p-2 border-r border-b shadow-sm group-hover:bg-slate-50",children:(0,s.jsx)("div",{className:"flex justify-between items-center w-32",children:(0,s.jsx)("span",{className:"text-[10px] font-bold truncate",children:e.name})})}),ev.map(t=>{let a="".concat(e.id,"_").concat(getDateKey(t)),n=T[a],r=eh[a],i=O[a],l=null,o="",c=isCellSelected(e.id,t);return r?r.isDeleted?(l=(0,s.jsx)(x.Z,{size:12}),o="bg-rose-50 text-rose-300"):(l=r.code,o="bg-amber-100 text-amber-700 border-amber-300 ring-2 ring-inset ring-amber-400"):i?o=v[l=getAbsenceCode(i.type)]||v["Ausencia con Aviso"]:n&&(o=getDefaultStyle(l=n.code)),(0,s.jsx)("td",{onMouseDown:()=>handleMouseDown(a),onMouseEnter:()=>handleMouseEnter(a),className:"border-b border-r p-0.5 cursor-pointer text-center relative transition-colors ".concat(c?"bg-indigo-200":""),children:(0,s.jsx)("div",{className:"w-full h-8 rounded flex items-center justify-center text-[10px] font-black ".concat(o," ").concat(c?"ring-2 ring-indigo-500 z-10":""),children:l})},a)})]},e.id))})]})})}):(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center bg-slate-50 rounded-3xl border-2 border-dashed text-slate-400",children:[(0,s.jsx)(h.Z,{size:48,className:"mb-4 opacity-50"}),(0,s.jsx)("h3",{className:"text-lg font-black uppercase",children:"Seleccione Objetivo"})]})]})]})}}},function(e){e.O(0,[761,897,963,712,354,774,888,179],function(){return e(e.s=70429)}),_N_E=e.O()}]);