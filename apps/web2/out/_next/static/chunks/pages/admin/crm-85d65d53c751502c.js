(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[993],{10381:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]])},46309:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},54980:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]])},13766:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},56953:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},54976:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},22448:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},19769:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},31012:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},29445:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]])},87764:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},13718:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},94933:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(84297);let n=(0,a.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},80985:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/crm",function(){return s(72516)}])},43475:function(e,t,s){"use strict";s.d(t,{Z:function(){return DashboardLayout}});var a=s(85893),n=s(67294),l=s(41664),i=s.n(l),o=s(11163),r=s(41503),d=s(28477),c=s(85876),x=s(64712),p=s(54463),m=s(41352),h=s(39483),u=s(72367),f=s(34622),g=s(28909),b=s(81629),v=s(49525),j=s(71408),y=s(78051),N=s(77232);function DashboardLayout(e){let{children:t}=e,[s,l]=(0,n.useState)(!0),w=(0,o.useRouter)(),{user:k}=(0,r.a)(),handleLogout=async()=>{try{await (0,c.w7)(d.I8),window.location.href="/login"}catch(e){console.error("Error cerrando sesi\xf3n:",e)}},isActive=e=>w.pathname.startsWith(e),getLinkClass=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium text-sm ".concat(s?"":"justify-center px-2");return isActive(e)?"".concat(a," bg-indigo-600 text-white shadow-lg shadow-indigo-900/50"):t?"".concat(a," bg-rose-600/10 text-rose-400 hover:bg-rose-600 hover:text-white border border-rose-900/50 hover:border-rose-500"):"".concat(a," text-slate-300 hover:bg-slate-800 hover:text-white")};return(0,a.jsxs)("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300 flex",children:[(0,a.jsx)(x.x7,{position:"top-right",richColors:!0,closeButton:!0,expand:!0}),(0,a.jsxs)("aside",{className:"fixed top-0 left-0 z-40 h-screen transition-all duration-300 bg-slate-900 text-white border-r border-slate-800 flex flex-col\n        ".concat(s?"w-64 translate-x-0":"w-20 -translate-x-full lg:translate-x-0"," \n        "),children:[(0,a.jsxs)("div",{className:"p-6 flex items-center ".concat(s?"justify-between":"justify-center"," shrink-0"),children:[s?(0,a.jsx)("span",{className:"text-xl font-black tracking-tighter text-indigo-400",children:"CRONOAPP"}):(0,a.jsx)(p.Z,{className:"text-indigo-400"}),(0,a.jsx)("button",{onClick:()=>l(!1),className:"lg:hidden text-slate-400 hover:text-white",children:(0,a.jsx)(m.Z,{})})]}),(0,a.jsxs)("nav",{className:"px-3 space-y-2 mt-4 flex-1 overflow-y-auto custom-scrollbar",children:[s&&(0,a.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Operativa"}),(0,a.jsxs)(i(),{href:"/admin/dashboard",className:getLinkClass("/admin/dashboard"),title:"Dashboard",children:[(0,a.jsx)(h.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"Dashboard"})]}),(0,a.jsxs)(i(),{href:"/admin/operaciones",className:getLinkClass("/admin/operaciones",!0),title:"Centro Control",children:[(0,a.jsx)(u.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"Centro Control"})]}),(0,a.jsxs)(i(),{href:"/admin/planificacion",className:getLinkClass("/admin/planificacion"),title:"Planificador",children:[(0,a.jsx)(f.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"Planificador"})]}),s&&(0,a.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest mt-4",children:"Gesti\xf3n"}),(0,a.jsxs)(i(),{href:"/admin/crm",className:getLinkClass("/admin/crm"),title:"CRM Clientes",children:[(0,a.jsx)(g.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"CRM Clientes"})]}),(0,a.jsxs)(i(),{href:"/admin/servicios",className:getLinkClass("/admin/servicios"),title:"Servicios",children:[(0,a.jsx)(p.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"Servicios"})]}),(0,a.jsxs)(i(),{href:"/admin/reportes",className:getLinkClass("/admin/reportes"),title:"Reportes",children:[(0,a.jsx)(b.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"Reportes"})]}),(0,a.jsxs)(i(),{href:"/admin/rrhh",className:getLinkClass("/admin/rrhh"),title:"RRHH",children:[(0,a.jsx)(v.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"RRHH"})]}),s&&(0,a.jsx)("div",{className:"px-4 py-2 text-[10px] font-black text-slate-500 uppercase tracking-widest mt-4",children:"Sistema"}),(0,a.jsxs)(i(),{href:"/admin/configuracion",className:getLinkClass("/admin/configuracion"),title:"Configuraci\xf3n",children:[(0,a.jsx)(j.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"Configuraci\xf3n"})]})]}),(0,a.jsx)("div",{className:"p-4 border-t border-slate-800 shrink-0 flex flex-col gap-2",children:(0,a.jsxs)("button",{onClick:handleLogout,className:"w-full flex items-center justify-center gap-3 px-4 py-3 text-rose-400 hover:bg-rose-900/20 hover:text-rose-300 rounded-xl transition-all font-medium text-sm",title:"Cerrar Sesi\xf3n",children:[(0,a.jsx)(y.Z,{size:20})," ",s&&(0,a.jsx)("span",{children:"Salir"})]})})]}),(0,a.jsxs)("div",{className:"flex-1 transition-all duration-300 ".concat(s?"lg:ml-64":"lg:ml-20"),children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-slate-800 p-4 shadow-sm border-b border-slate-200 dark:border-slate-700 flex items-center gap-4 sticky top-0 z-30",children:[(0,a.jsx)("button",{onClick:()=>l(!s),className:"p-2 rounded-lg hover:bg-slate-100 text-slate-600 dark:text-slate-200 transition-colors",children:(0,a.jsx)(N.Z,{size:24})}),(0,a.jsx)("span",{className:"font-black text-slate-700 dark:text-white uppercase tracking-tight",children:s?"Panel de Control":"CronoApp"})]}),(0,a.jsx)("main",{className:"p-4 lg:p-8",children:t})]})]})}},41503:function(e,t,s){"use strict";s.d(t,{a:function(){return useAuth}}),s(85893);var a=s(67294);s(85876),s(28477),s(11163);let n=(0,a.createContext)({user:null,loading:!0,logout:async()=>{}}),useAuth=()=>(0,a.useContext)(n)},28477:function(e,t,s){"use strict";s.d(t,{I8:function(){return r},db:function(){return d},wk:function(){return c}});var a=s(83977),n=s(85876),l=s(93504),i=s(23914);let o=(0,a.C6)().length?(0,a.Mq)():(0,a.ZF)({apiKey:"AIzaSyBJaTiMekwbGPXAm-mkPl_u6KEWCSpvfic",authDomain:"comtroldata.firebaseapp.com",projectId:"comtroldata",storageBucket:"comtroldata.firebasestorage.app",messagingSenderId:"698108879063",appId:"1:698108879063:web:ab30eb8b80a774f52f1092"}),r=(0,n.v0)(o),d=(0,l.ad)(o),c=(0,i.$C)(o)},72516:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return CRMPage}});var a=s(85893),n=s(67294),l=s(9008),i=s.n(l),o=s(11163),r=s(43475),d=s(28477),c=s(93504),x=s(85876),p=s(64712),m=s(54980),h=s(31012),u=s(87764),f=s(46309),g=s(56953),b=s(19769),v=s(54976),j=s(22448),y=s(34622),N=s(13766),w=s(84297);let k=(0,w.Z)("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]),C=(0,w.Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);var S=s(13718),A=s(94933),I=s(10381);let z=(0,w.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var Z=s(41352),M=s(29445);let E={name:"BACAR SA",cuit:"30-66813497-8",address:"Santiago del Estero 263 - C\xf3rdoba"};function CRMPage(){var e,t,s,l,w,O,R,D,T,P,F,L,_;let V=(0,o.useRouter)(),[q,H]=(0,n.useState)("list"),[U,G]=(0,n.useState)("INFO"),[B,J]=(0,n.useState)("Cargando..."),[W,$]=(0,n.useState)([]),[K,Q]=(0,n.useState)([]),[X,Y]=(0,n.useState)(null),[ee,et]=(0,n.useState)([]),[es,ea]=(0,n.useState)([]),[en,el]=(0,n.useState)(""),[ei,eo]=(0,n.useState)(""),[er,ed]=(0,n.useState)(!1),[ec,ex]=(0,n.useState)(!1),[ep,em]=(0,n.useState)({}),[eh,eu]=(0,n.useState)(null),[ef,eg]=(0,n.useState)({}),[eb,ev]=(0,n.useState)([]),[ej,ey]=(0,n.useState)(!1),[eN,ew]=(0,n.useState)(!1),ek=(0,n.useRef)(null),eC=(0,n.useRef)(null),[eS,eA]=(0,n.useState)(null),[eI,ez]=(0,n.useState)({}),[eZ,eM]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(V.query.clientId&&W.length>0){let e=W.find(e=>e.id===V.query.clientId);e&&(Y(e),H("detail"),G("COTIZACIONES"))}},[V.query.clientId,W]);let irACotizador=()=>{if(!X||!X.id){p.Am.error("Error: Cliente no seleccionado.");return}V.push({pathname:"/admin/cotizador",query:{clientId:X.id}})},printQuote=e=>{var t,s,a;let n=window.open("","_blank");if(!n)return p.Am.error("Permite los pop-ups para imprimir");let l="";l=e.params.servicios&&Array.isArray(e.params.servicios)?e.params.servicios.map(t=>{var s;return'\n                <div style="margin-bottom:8px; border-bottom:1px solid #000; padding-bottom:5px;">\n                    <strong style="color:#000; font-size:12px;">'.concat(t.nombre,'</strong><br/>\n                    <span style="font-size:11px; color:#000;">\n                        ').concat(t.cantidad," Puesto/s • ").concat(t.horas," Hs Diarias • \n                        ").concat("evento"===e.params.modalidad?"Evento (".concat(e.params.diasEvento," d\xedas)"):"Mensual (".concat((null===(s=t.dias)||void 0===s?void 0:s.length)||7," d\xedas/sem)"),"\n                    </span>\n                </div>\n            ")}).join(""):'<div style="color:red">Error: Formato de servicio antiguo.</div>';let i=(null===(t=e.items)||void 0===t?void 0:t.map(e=>'\n            <tr>\n                <td style="padding: 8px; border-bottom: 1px solid #ccc;">'.concat(e.nombre,'</td>\n                <td style="padding: 8px; border-bottom: 1px solid #ccc; text-align: right;">').concat("fijo"===e.tipo?"\xdanico (Amort.)":"Mensual",'</td>\n                <td style="padding: 8px; border-bottom: 1px solid #ccc; text-align: right; font-weight: bold;">$').concat(new Intl.NumberFormat("es-AR").format(e.costo),"</td>\n            </tr>\n        ")).join(""))||'<tr><td colspan="3" style="padding:10px; color:#999; font-style:italic;">Sin adicionales operativos</td></tr>',o=(null===(s=e.team)||void 0===s?void 0:s.map(e=>'\n            <tr>\n                <td style="padding: 8px; border-bottom: 1px solid #ccc; color: #333;"><strong>'.concat(e.cantidad,"x</strong> ").concat(e.categoria,'</td>\n                <td style="padding: 8px; border-bottom: 1px solid #ccc; text-align: right; color: #666;">$').concat(new Intl.NumberFormat("es-AR").format(e.basico),'</td>\n                <td style="padding: 8px; border-bottom: 1px solid #ccc; text-align: right; font-weight: bold;">$').concat(new Intl.NumberFormat("es-AR").format(e.viatico),"</td>\n            </tr>\n        ")).join(""))||"",r="";if(e.proyeccion&&Array.isArray(e.proyeccion)){let t=e.proyeccion.map(e=>'\n                <tr>\n                    <td style="padding:6px; border-bottom:1px solid #ccc;">'.concat(e.mes,'</td>\n                    <td style="padding:6px; border-bottom:1px solid #ccc; text-align:center;">').concat(Math.round(e.horas),' hs</td>\n                    <td style="padding:6px; border-bottom:1px solid #ccc; text-align:right; font-family:monospace; font-weight:bold;">$').concat(new Intl.NumberFormat("es-AR").format(e.venta),"</td>\n                </tr>\n            ")).join("");r='\n                <div class="section-title" style="margin-top:20px;">4. Proyecci\xf3n Financiera (Contrato '.concat(e.params.mesesContrato,' Meses)</div>\n                <table style="width:100%; border:1px solid #000;">\n                    <thead style="background:#f0f0f0;">\n                        <tr>\n                            <th style="text-align:left; padding:5px; font-size:10px; color:#000;">PERIODO</th>\n                            <th style="text-align:center; padding:5px; font-size:10px; color:#000;">HORAS</th>\n                            <th style="text-align:right; padding:5px; font-size:10px; color:#000;">VALOR CUOTA (+IVA)</th>\n                        </tr>\n                    </thead>\n                    <tbody>').concat(t,"</tbody>\n                </table>\n            ")}n.document.write("\n            <html>\n            <head>\n                <title>Cotizaci\xf3n #".concat(e.id.slice(0,6)," - ").concat(X.name,'</title>\n                <style>\n                    body { font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif; padding: 40px; color: #000; max-width: 900px; margin: 0 auto; }\n                    /* HEADER ROJO */\n                    .header { display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 3px solid #D32F2F; padding-bottom: 20px; margin-bottom: 40px; }\n                    .company-info h1 { font-size: 28px; color: #D32F2F; margin: 0; text-transform: uppercase; letter-spacing: 1px; font-weight: 900; }\n                    .company-info p { font-size: 12px; color: #000; margin: 2px 0; font-weight: bold; }\n                    .meta-info { text-align: right; }\n                    .meta-info h2 { font-size: 18px; color: #000; margin: 0 0 5px 0; font-weight: 900; }\n                    .meta-info p { font-size: 12px; color: #000; margin: 2px 0; }\n                    \n                    .client-box { border: 1px solid #000; padding: 15px; margin-bottom: 30px; display: flex; justify-content: space-between; background: #fff; }\n                    .client-box div h3 { font-size: 10px; text-transform: uppercase; color: #D32F2F; margin: 0 0 5px 0; font-weight: bold; }\n                    .client-box div p { font-size: 14px; font-weight: bold; margin: 0; color: #000; }\n\n                    .section-title { font-size: 14px; font-weight: 900; text-transform: uppercase; color: #000; margin-bottom: 15px; border-bottom: 2px solid #000; padding-bottom: 5px; margin-top:30px; }\n                    \n                    table { width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 30px; }\n                    th { text-align: left; background: #000; padding: 10px; color: #fff; text-transform: uppercase; font-size: 10px; }\n                    \n                    .totals-container { display: flex; justify-content: flex-end; margin-top: 20px; }\n                    .totals-box { width: 300px; text-align: right; border-top: 3px solid #000; padding-top: 10px; }\n                    .totals-row { display: flex; justify-content: space-between; padding: 5px 0; font-size: 12px; color: #000; }\n                    .totals-row.final { border-top: 1px solid #000; margin-top: 10px; padding-top: 10px; font-size: 20px; font-weight: 900; color: #D32F2F; }\n                    \n                    .footer { margin-top: 60px; font-size: 10px; text-align: center; color: #000; border-top: 1px solid #000; padding-top: 20px; font-weight: bold; }\n                </style>\n            </head>\n            <body>\n                <div class="header">\n                    <div class="company-info">\n                        <h1>').concat(E.name,"</h1>\n                        <p>").concat(E.address,"</p>\n                        <p>CUIT: ").concat(E.cuit,'</p>\n                    </div>\n                    <div class="meta-info">\n                        <h2>PRESUPUESTO OFICIAL</h2>\n                        <p><strong>Nro:</strong> #').concat(e.id.slice(0,6).toUpperCase(),"</p>\n                        <p><strong>Fecha:</strong> ").concat(new Date((null===(a=e.createdAt)||void 0===a?void 0:a.seconds)*1e3).toLocaleDateString(),'</p>\n                        <p><strong>Vencimiento:</strong> 15 D\xedas</p>\n                    </div>\n                </div>\n\n                <div class="client-box">\n                    <div>\n                        <h3>Cliente</h3>\n                        <p>').concat(X.name,'</p>\n                        <p style="font-size:12px; font-weight:normal;">').concat(X.taxId||"CUIT Pendiente",'</p>\n                    </div>\n                    <div style="text-align:right">\n                        <h3>Direcci\xf3n del Objetivo</h3>\n                        <p>').concat(e.params.cliente||"Sede Principal",'</p>\n                        <p style="font-size:12px; font-weight:normal;">').concat(X.address||"-",'</p>\n                    </div>\n                </div>\n\n                <div class="section-title">1. Configuraci\xf3n del Servicio</div>\n                ').concat(l,'\n\n                <div class="section-title">2. Dotaci\xf3n Asignada (RRHH)</div>\n                <table>\n                    <thead><tr><th>Perfil Profesional</th><th style="text-align:right">Ref. B\xe1sico</th><th style="text-align:right">Ref. Vi\xe1tico</th></tr></thead>\n                    <tbody>').concat(o,'</tbody>\n                </table>\n\n                <div class="section-title">3. Recursos Tecnol\xf3gicos y Operativos</div>\n                <table>\n                    <thead><tr><th>\xcdtem / Recurso</th><th style="text-align:right">Modalidad</th><th style="text-align:right">Costo Unitario</th></tr></thead>\n                    <tbody>').concat(i,"</tbody>\n                </table>\n\n                ").concat(r,'\n\n                <div class="totals-container">\n                    <div class="totals-box">\n                        <div class="totals-row"><span>Costo Financiero (').concat(e.params.diasPago," d\xedas)</span> <span>$").concat(new Intl.NumberFormat("es-AR").format(e.results.costoFinanciero||0),'</span></div>\n                        <div class="totals-row"><span>Impuestos (IIBB+Tasas)</span> <span>Incluidos</span></div>\n                        <div class="totals-row final"><span>TOTAL CONTRATO</span> <span>$').concat(new Intl.NumberFormat("es-AR").format(e.results.valorTotalContrato||e.results.precioVentaTotal),'</span></div>\n                        <p style="font-size:10px; color:#000; margin-top:5px; font-weight:bold;">+ IVA (21%)</p>\n                    </div>\n                </div>\n\n                <div class="footer">\n                    <p>Este documento es una propuesta comercial y no representa una factura fiscal.</p>\n                    <p>').concat(E.name," - Seguridad Privada Inteligente</p>\n                </div>\n                <script>window.print();</script>\n            </body>\n            </html>\n        ")),n.document.close()};(0,n.useEffect)(()=>{if(window.google&&window.google.maps){ew(!0),initServices();return}let e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyA0Nl6OOJI8swRVQ8uzAKpPHdE2zvEscOE","&libraries=places"),e.async=!0,e.defer=!0,e.onload=()=>{ew(!0),initServices()},document.head.appendChild(e)},[]);let initServices=()=>{if(window.google)try{ek.current=new window.google.maps.places.AutocompleteService,eC.current=new window.google.maps.Geocoder}catch(e){console.error(e)}};(0,n.useEffect)(()=>{let e=(0,x.v0)();(0,x.Aj)(e,e=>{J(e?e.displayName||e.email||"Usuario":"No Logueado")}),fetchClients()},[]),(0,n.useEffect)(()=>{if(!W.length)return;let e=en.toLowerCase();Q(W.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.fantasyName||"").toLowerCase().includes(e)||(t.taxId||"").includes(e)))},[en,W]),(0,n.useEffect)(()=>{X&&("SERVICIOS"===U&&loadServices(X.id),"COTIZACIONES"===U&&loadQuotes(X.id))},[X,U]);let fetchClients=async()=>{try{let e=(0,c.IO)((0,c.hJ)(d.db,"clients"),(0,c.Xo)("name")),t=await (0,c.PL)(e),s=t.docs.map(e=>({id:e.id,...e.data()}));$(s),Q(s)}catch(e){console.error(e)}},loadServices=async e=>{try{let t=(0,c.IO)((0,c.hJ)(d.db,"servicios_sla"),(0,c.ar)("clientId","==",e)),s=await (0,c.PL)(t),a=s.docs.map(e=>({id:e.id,...e.data()}));if(0===a.length){let t=(0,c.IO)((0,c.hJ)(d.db,"services"),(0,c.ar)("clientId","==",e)),s=await (0,c.PL)(t);a.push(...s.docs.map(e=>({id:e.id,...e.data()})))}let n=a.map(e=>({id:e.id,name:e.objectiveName||e.name||"Servicio",start:e.startDate||e.start_date||e.fechaInicio||e.createdAt,status:e.status||"Activo",positions:e.positions||[],_raw:e}));et(n)}catch(e){console.error(e)}},loadQuotes=async e=>{try{let t=(0,c.IO)((0,c.hJ)(d.db,"quotes"),(0,c.ar)("clientId","==",e),(0,c.Xo)("createdAt","desc")),s=await (0,c.PL)(t),a=s.docs.map(e=>({id:e.id,...e.data()}));ea(a)}catch(e){console.error("Error quotes",e),"failed-precondition"===e.code&&p.Am.error("Falta \xedndice en Firebase. Revisa consola F12.")}},handleGoogleSearch=e=>{let t=extractCoordinates(e);if(t){eg({...ef,lat:t.lat,lng:t.lng,coords:"".concat(t.lat,",").concat(t.lng),address:e.includes("http")?"Ubicaci\xf3n Pegada (Link)":"Coordenadas Manuales"}),p.Am.success("Coordenadas: ".concat(t.lat,", ").concat(t.lng)),ev([]),ey(!1);return}if(eg({...ef,address:e}),!e||e.length<3||!eN||!ek.current){ev([]);return}ek.current.getPlacePredictions({input:e,componentRestrictions:{country:"ar"}},(e,t)=>{t===window.google.maps.places.PlacesServiceStatus.OK&&e?(ev(e),ey(!0)):ev([])})},extractCoordinates=e=>{let t=e.match(/@(-?\d+\.\d+),(-?\d+\.\d+)/);return t||(t=e.match(/q=(-?\d+\.\d+),(-?\d+\.\d+)/))||(t=e.match(/!3d(-?\d+\.\d+)!4d(-?\d+\.\d+)/))||(t=e.match(/^(-?\d+\.\d+)[,\s]+(-?\d+\.\d+)$/))?{lat:t[1],lng:t[2]}:null},selectGoogleAddress=e=>{eC.current&&eC.current.geocode({placeId:e.place_id},(t,s)=>{if("OK"===s&&t[0]){let s=t[0].geometry.location;eg({...ef,address:e.description,lat:s.lat().toString(),lng:s.lng().toString(),coords:"".concat(s.lat(),",").concat(s.lng())}),ev([]),ey(!1),p.Am.success("Ubicaci\xf3n encontrada")}else p.Am.error("Error coordenadas")})},handleSaveInfo=async()=>{if(!ep.name)return p.Am.error("Nombre requerido");try{await (0,c.r7)((0,c.JU)(d.db,"clients",X.id),ep),Y({...X,...ep}),ex(!1),p.Am.success("Guardado")}catch(e){p.Am.error("Error")}},saveObjective=async()=>{try{let e=[...X.objetivos||[]],t={...ef,lat:ef.lat||"",lng:ef.lng||""};"NEW"===eh?e.push({...t,id:Date.now().toString()}):e=e.map(e=>e.id===eh?{...e,...t}:e),await (0,c.r7)((0,c.JU)(d.db,"clients",X.id),{objetivos:e}),Y({...X,objetivos:e}),eu(null),eg({}),p.Am.success("Sede guardada")}catch(e){p.Am.error("Error")}},deleteObjective=async e=>{if(!confirm("\xbfBorrar?"))return;let t=X.objetivos.filter(t=>t.id!==e);await (0,c.r7)((0,c.JU)(d.db,"clients",X.id),{objetivos:t}),Y({...X,objetivos:t})},saveContact=async()=>{try{let e=[...X.contactos||[]];"NEW"===eS?e.push({...eI,id:Date.now().toString()}):e=e.map(e=>e.id===eS?{...e,...eI}:e),await (0,c.r7)((0,c.JU)(d.db,"clients",X.id),{contactos:e}),Y({...X,contactos:e}),eA(null),p.Am.success("Contacto guardado")}catch(e){p.Am.error("Error")}},deleteContact=async e=>{if(!confirm("\xbfBorrar?"))return;let t=X.contactos.filter(t=>t.id!==e);await (0,c.r7)((0,c.JU)(d.db,"clients",X.id),{contactos:t}),Y({...X,contactos:t})},handleCreateNew=async()=>{let e={name:"Nuevo Cliente",status:"ACTIVE",createdAt:new Date().toISOString(),objetivos:[],contactos:[]},t=await (0,c.ET)((0,c.hJ)(d.db,"clients"),e);fetchClients(),Y({id:t.id,...e}),em({id:t.id,...e}),ex(!0),H("detail")},handleAddHistory=async()=>{if(!ei)return;let e={date:new Date().toISOString(),note:ei,user:B};await (0,c.r7)((0,c.JU)(d.db,"clients",X.id),{historial:(0,c.vr)(e)}),Y({...X,historial:[...X.historial||[],e]}),eo("")},formatMoney=e=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",maximumFractionDigits:0}).format(e||0),getStatusColor=e=>"INACTIVE"===e?"bg-slate-100 text-slate-500":"SUSPENDED"===e?"bg-amber-100 text-amber-700":"bg-emerald-100 text-emerald-700";return(0,a.jsxs)(r.Z,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:"CRM | Gesti\xf3n de Clientes"})}),(0,a.jsx)(p.x7,{position:"top-center"}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-4 space-y-6 animate-in fade-in",children:[(0,a.jsxs)("header",{className:"flex justify-between items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-black uppercase text-slate-800",children:"CRM"}),(0,a.jsxs)("p",{className:"text-[10px] text-indigo-500 mt-1",children:["Usuario Activo: ",(0,a.jsx)("b",{children:B})]})]}),"detail"===q&&X?(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{type:"button",onClick:irACotizador,className:"bg-emerald-100 text-emerald-700 px-4 py-2 rounded-xl text-xs font-bold uppercase flex gap-2 items-center hover:bg-emerald-200 transition-colors shadow-sm",children:[(0,a.jsx)(m.Z,{size:16})," Cotizar"]}),(0,a.jsx)("button",{onClick:()=>H("list"),className:"text-slate-500 font-bold text-xs uppercase px-3 py-2 border border-slate-200 rounded-xl hover:bg-slate-50",children:"Volver"})]}):(0,a.jsxs)("button",{onClick:handleCreateNew,className:"bg-indigo-600 text-white px-4 py-2 rounded-xl text-xs font-bold uppercase flex gap-2",children:[(0,a.jsx)(h.Z,{size:16})," Nuevo Cliente"]})]}),"list"===q&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"text-slate-400",size:18}),(0,a.jsx)("input",{className:"w-full bg-transparent outline-none font-bold text-sm",placeholder:"Buscar...",value:en,onChange:e=>el(e.target.value)})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:K.map(e=>(0,a.jsxs)("div",{onClick:()=>{Y(e),em({}),ex(!1),G("INFO"),H("detail")},className:"bg-white p-5 rounded-2xl border hover:shadow-md cursor-pointer transition-all",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)(f.Z,{className:"text-indigo-500"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded text-[10px] font-black uppercase ".concat(getStatusColor(e.status)),children:e.status||"Activo"})]}),(0,a.jsx)("h3",{className:"font-black text-lg truncate",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-slate-500 font-bold uppercase",children:e.fantasyName||"-"})]},e.id))})]}),"detail"===q&&X&&(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,a.jsxs)("div",{className:"w-full lg:w-1/3 bg-white p-6 rounded-3xl border h-fit",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4 text-indigo-600",children:(0,a.jsx)(f.Z,{size:40})}),(0,a.jsx)("h2",{className:"text-xl font-black",children:X.name}),(0,a.jsx)("p",{className:"text-sm font-bold text-slate-500",children:X.taxId||"CUIT No Informado"})]}),(0,a.jsxs)("div",{className:"space-y-3 text-xs font-bold text-slate-600",children:[(0,a.jsxs)("div",{className:"p-3 bg-slate-50 rounded-xl flex gap-3",children:[(0,a.jsx)(g.Z,{size:16})," ",X.email||"-"]}),(0,a.jsxs)("div",{className:"p-3 bg-slate-50 rounded-xl flex gap-3",children:[(0,a.jsx)(b.Z,{size:16})," ",X.phone||"-"]}),(0,a.jsxs)("div",{className:"p-3 bg-slate-50 rounded-xl flex gap-3",children:[(0,a.jsx)(v.Z,{size:16})," ",X.city||X.address||"-"]})]})]}),(0,a.jsxs)("div",{className:"flex-1 bg-white rounded-3xl border overflow-hidden flex flex-col min-h-[600px]",children:[(0,a.jsx)("div",{className:"flex border-b overflow-x-auto bg-slate-50/50",children:["INFO","COTIZACIONES","SEDES","CONTACTOS","SERVICIOS","HISTORIAL"].map(e=>(0,a.jsx)("button",{onClick:()=>G(e),className:"px-6 py-4 text-xs font-black uppercase border-b-2 whitespace-nowrap transition-colors ".concat(U===e?"border-indigo-600 text-indigo-600 bg-white":"border-transparent text-slate-400 hover:text-slate-600"),children:e},e))}),(0,a.jsxs)("div",{className:"p-6 flex-1 overflow-y-auto",children:["INFO"===U&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"font-bold text-sm uppercase text-slate-700",children:"Ficha de Cliente"}),ec?(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>ex(!1),className:"text-slate-400 text-xs font-bold",children:"Cancelar"}),(0,a.jsx)("button",{onClick:handleSaveInfo,className:"text-emerald-600 text-xs font-bold",children:"Guardar"})]}):(0,a.jsxs)("button",{onClick:()=>{em({...X}),ex(!0)},className:"text-indigo-600 text-xs font-bold uppercase flex gap-1 hover:underline",children:[(0,a.jsx)(j.Z,{size:12})," Editar"]})]}),ec?(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 animate-in fade-in",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"text-[10px] font-bold text-slate-400",children:"Raz\xf3n Social"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded font-bold",value:ep.name||"",onChange:e=>em({...ep,name:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] font-bold text-slate-400",children:"CUIT"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded",value:ep.taxId||"",onChange:e=>em({...ep,taxId:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-[10px] font-bold text-slate-400",children:"Tel\xe9fono"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded",value:ep.phone||"",onChange:e=>em({...ep,phone:e.target.value})})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"text-[10px] font-bold text-slate-400",children:"Email"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded",value:ep.email||"",onChange:e=>em({...ep,email:e.target.value})})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"text-[10px] font-bold text-slate-400",children:"Direcci\xf3n"}),(0,a.jsx)("input",{className:"w-full p-2 border rounded",value:ep.address||"",onChange:e=>em({...ep,address:e.target.value})})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-3 bg-white border rounded-xl",children:[(0,a.jsx)("label",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Raz\xf3n Social"}),(0,a.jsx)("p",{className:"font-bold text-sm",children:X.name})]}),(0,a.jsxs)("div",{className:"p-3 bg-white border rounded-xl",children:[(0,a.jsx)("label",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Fantas\xeda"}),(0,a.jsx)("p",{className:"font-bold text-sm",children:X.fantasyName||"-"})]}),(0,a.jsxs)("div",{className:"p-3 bg-white border rounded-xl",children:[(0,a.jsx)("label",{className:"text-[9px] font-black text-slate-400 uppercase",children:"CUIT"}),(0,a.jsx)("p",{className:"font-bold text-sm",children:X.taxId||"-"})]}),(0,a.jsxs)("div",{className:"p-3 bg-white border rounded-xl",children:[(0,a.jsx)("label",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Tipo"}),(0,a.jsx)("p",{className:"font-bold text-sm",children:"FISICA"===X.clientType?"Persona F\xedsica":"Empresa"})]})]}),(0,a.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 flex gap-4 items-center",children:[(0,a.jsx)(v.Z,{className:"text-slate-400"}),(0,a.jsx)("p",{className:"font-bold text-sm",children:X.address||"Sin direcci\xf3n"})]})]})]}),"COTIZACIONES"===U&&(0,a.jsxs)("div",{className:"space-y-4 animate-in slide-in-from-right-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"font-bold text-sm uppercase text-slate-700",children:"Historial de Propuestas"}),(0,a.jsxs)("button",{type:"button",onClick:irACotizador,className:"bg-indigo-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold flex gap-2 items-center hover:bg-indigo-700 transition-colors shadow-sm",children:[(0,a.jsx)(h.Z,{size:14})," Nueva Cotizaci\xf3n"]})]}),es.length>0?(0,a.jsx)("div",{className:"overflow-hidden border rounded-xl",children:(0,a.jsxs)("table",{className:"w-full text-left text-xs",children:[(0,a.jsx)("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase border-b",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-3",children:"Fecha"}),(0,a.jsx)("th",{className:"p-3",children:"Servicio"}),(0,a.jsx)("th",{className:"p-3 text-right",children:"Monto Total"}),(0,a.jsx)("th",{className:"p-3 text-center",children:"Estado"}),(0,a.jsx)("th",{className:"p-3 text-right",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:es.map(e=>{var t,s,n,l,i;return(0,a.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors",children:[(0,a.jsxs)("td",{className:"p-3 font-medium flex items-center gap-2",children:[(0,a.jsx)(y.Z,{size:14,className:"text-slate-400"})," ",e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString():"-"]}),(0,a.jsxs)("td",{className:"p-3 text-slate-600",children:[(null===(t=e.params)||void 0===t?void 0:t.servicios)?"".concat(e.params.servicios.length," Servicios"):"".concat((null===(s=e.params)||void 0===s?void 0:s.puestos)||1," Puesto")," • ",null===(n=e.params)||void 0===n?void 0:n.modalidad]}),(0,a.jsx)("td",{className:"p-3 text-right font-black text-slate-800",children:formatMoney((null===(l=e.results)||void 0===l?void 0:l.valorTotalContrato)||(null===(i=e.results)||void 0===i?void 0:i.precioVentaTotal))}),(0,a.jsx)("td",{className:"p-3 text-center",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-[10px] font-bold uppercase ".concat("APROBADA"===e.status?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"),children:e.status||"Borrador"})}),(0,a.jsx)("td",{className:"p-3 text-right",children:(0,a.jsx)("button",{onClick:()=>eM(e),className:"p-1.5 text-slate-400 hover:text-indigo-600 bg-white border rounded hover:bg-indigo-50",title:"Ver / Imprimir",children:(0,a.jsx)(N.Z,{size:14})})})]},e.id)})})]})}):(0,a.jsxs)("div",{className:"text-center py-12 bg-slate-50 border-2 border-dashed border-slate-200 rounded-xl",children:[(0,a.jsx)(N.Z,{className:"mx-auto h-12 w-12 text-slate-300 mb-3"}),(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-600",children:"No hay cotizaciones"}),(0,a.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Crea una nueva propuesta comercial para este cliente."})]})]}),"SEDES"===U&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("button",{onClick:()=>{eu("NEW"),eg({name:"",address:""})},className:"text-indigo-600 text-xs font-bold uppercase hover:underline",children:"+ Agregar Sede"}),"NEW"===eh&&(0,a.jsxs)("div",{className:"p-4 bg-indigo-50 border rounded-xl space-y-3 relative",children:[(0,a.jsx)("input",{autoFocus:!0,placeholder:"Nombre Sede",className:"w-full p-2 rounded border",value:ef.name,onChange:e=>eg({...ef,name:e.target.value})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{placeholder:"\uD83D\uDD0D Buscar direcci\xf3n o pegar link de Maps...",className:"w-full p-2 rounded border border-indigo-200 focus:border-indigo-500 outline-none transition-colors",value:ef.address,onChange:e=>handleGoogleSearch(e.target.value),onFocus:()=>{var e;return(null===(e=ef.address)||void 0===e?void 0:e.length)>2&&ey(!0)},onBlur:()=>setTimeout(()=>ey(!1),200)}),ej&&(0,a.jsx)("ul",{className:"absolute z-50 left-0 right-0 top-full mt-1 bg-white border rounded-xl shadow-xl max-h-60 overflow-y-auto animate-in fade-in",children:eb.map(e=>{var t,s;return(0,a.jsxs)("li",{onClick:()=>selectGoogleAddress(e),className:"p-3 text-xs hover:bg-indigo-50 cursor-pointer border-b flex items-start gap-2",children:[(0,a.jsx)(v.Z,{size:14,className:"text-emerald-500 mt-0.5 shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold block",children:(null===(t=e.structured_formatting)||void 0===t?void 0:t.main_text)||e.description}),(0,a.jsx)("span",{className:"text-[10px] text-slate-500",children:null===(s=e.structured_formatting)||void 0===s?void 0:s.secondary_text})]})]},e.place_id)})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{className:"w-1/2 p-2 rounded border text-xs font-mono",value:ef.lat||"",onChange:e=>eg({...ef,lat:e.target.value})}),(0,a.jsx)("input",{className:"w-1/2 p-2 rounded border text-xs font-mono",value:ef.lng||"",onChange:e=>eg({...ef,lng:e.target.value})})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>eu(null),className:"px-3 py-1 bg-white rounded text-xs",children:"Cancelar"}),(0,a.jsx)("button",{onClick:saveObjective,className:"px-3 py-1 bg-indigo-600 text-white rounded text-xs",children:"Guardar"})]})]}),null===(e=X.objetivos)||void 0===e?void 0:e.map(e=>(0,a.jsx)("div",{className:"p-3 border rounded-xl bg-slate-50",children:eh===e.id?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("input",{className:"w-full p-2 rounded border font-bold",value:ef.name,onChange:e=>eg({...ef,name:e.target.value})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{className:"w-full p-2 rounded border",value:ef.address,onChange:e=>handleGoogleSearch(e.target.value),onFocus:()=>{var e;return(null===(e=ef.address)||void 0===e?void 0:e.length)>2&&ey(!0)},onBlur:()=>setTimeout(()=>ey(!1),200)}),ej&&(0,a.jsx)("ul",{className:"absolute z-50 left-0 right-0 top-full mt-1 bg-white border rounded-xl shadow-xl max-h-60 overflow-y-auto animate-in fade-in",children:eb.map(e=>{var t,s;return(0,a.jsxs)("li",{onClick:()=>selectGoogleAddress(e),className:"p-3 text-xs hover:bg-indigo-50 cursor-pointer border-b flex items-start gap-2",children:[(0,a.jsx)(v.Z,{size:14,className:"text-emerald-500 mt-0.5 shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold block",children:(null===(t=e.structured_formatting)||void 0===t?void 0:t.main_text)||e.description}),(0,a.jsx)("span",{className:"text-[10px] text-slate-500",children:null===(s=e.structured_formatting)||void 0===s?void 0:s.secondary_text})]})]},e.place_id)})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{className:"w-1/2 p-2 rounded border text-xs font-mono",value:ef.lat||"",onChange:e=>eg({...ef,lat:e.target.value})}),(0,a.jsx)("input",{className:"w-1/2 p-2 rounded border text-xs font-mono",value:ef.lng||"",onChange:e=>eg({...ef,lng:e.target.value})})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>eu(null),className:"text-xs",children:"Cancelar"}),(0,a.jsx)("button",{onClick:saveObjective,className:"text-xs text-emerald-600 font-bold",children:"Guardar"})]})]}):(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-bold text-sm text-slate-800",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:e.address}),e.lat&&e.lng&&(0,a.jsxs)("div",{className:"text-[10px] text-indigo-500 mt-1 flex items-center gap-1",children:[(0,a.jsx)(k,{size:10})," GPS Google OK"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[e.lat&&e.lng&&(0,a.jsx)("a",{href:"http://googleusercontent.com/maps.google.com/maps?q=".concat(e.lat,",").concat(e.lng),target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-white border rounded text-indigo-500 hover:bg-indigo-50",children:(0,a.jsx)(C,{size:14})}),(0,a.jsx)("button",{onClick:()=>{eu(e.id),eg(e)},className:"p-2 bg-white border rounded hover:text-indigo-600",children:(0,a.jsx)(j.Z,{size:14})}),(0,a.jsx)("button",{onClick:()=>deleteObjective(e.id),className:"p-2 bg-white border rounded hover:text-rose-500",children:(0,a.jsx)(S.Z,{size:14})})]})]})},e.id))]}),"CONTACTOS"===U&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("button",{onClick:()=>{eA("NEW"),ez({})},className:"text-indigo-600 text-xs font-bold uppercase hover:underline",children:"+ Agregar Contacto"}),"NEW"===eS&&(0,a.jsxs)("div",{className:"p-4 bg-indigo-50 border rounded-xl space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("input",{autoFocus:!0,placeholder:"Nombre",className:"p-2 rounded border",value:eI.name||"",onChange:e=>ez({...eI,name:e.target.value})}),(0,a.jsx)("input",{placeholder:"Cargo",className:"p-2 rounded border",value:eI.role||"",onChange:e=>ez({...eI,role:e.target.value})})]}),(0,a.jsx)("input",{placeholder:"Email / Tel",className:"w-full p-2 rounded border",value:eI.phone||"",onChange:e=>ez({...eI,phone:e.target.value})}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>eA(null),className:"px-3 py-1 bg-white rounded text-xs",children:"Cancelar"}),(0,a.jsx)("button",{onClick:saveContact,className:"px-3 py-1 bg-indigo-600 text-white rounded text-xs",children:"Guardar"})]})]}),null===(t=X.contactos)||void 0===t?void 0:t.map(e=>(0,a.jsx)("div",{className:"p-4 bg-white border rounded-xl flex justify-between items-center",children:eS===e.id?(0,a.jsxs)("div",{className:"flex-1 space-y-2 mr-4",children:[(0,a.jsx)("input",{className:"w-full p-1 border rounded",value:eI.name,onChange:e=>ez({...eI,name:e.target.value})}),(0,a.jsx)("input",{className:"w-full p-1 border rounded",value:eI.phone,onChange:e=>ez({...eI,phone:e.target.value})}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>eA(null),className:"text-xs",children:"Cancelar"}),(0,a.jsx)("button",{onClick:saveContact,className:"text-xs text-emerald-600 font-bold",children:"Guardar"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 font-black",children:(0,a.jsx)(A.Z,{size:14})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-sm",children:e.name}),(0,a.jsxs)("p",{className:"text-[10px] text-slate-400",children:[e.role," • ",e.phone]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{eA(e.id),ez(e)},className:"text-slate-300 hover:text-indigo-600",children:(0,a.jsx)(j.Z,{size:16})}),(0,a.jsx)("button",{onClick:()=>deleteContact(e.id),className:"text-slate-300 hover:text-rose-500",children:(0,a.jsx)(S.Z,{size:16})})]})]})},e.id))]}),"SERVICIOS"===U&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("h3",{className:"font-bold text-sm uppercase",children:"Servicios Activos"}),(0,a.jsxs)("button",{onClick:()=>ed(!er),className:"text-[10px] text-slate-300 flex gap-1 items-center hover:text-slate-500",children:[(0,a.jsx)(I.Z,{size:12})," Debug"]})]}),er&&(0,a.jsx)("div",{className:"p-4 bg-slate-900 text-emerald-400 font-mono text-[10px] rounded-xl overflow-auto max-h-40",children:JSON.stringify(ee,null,2)}),ee.map(e=>(0,a.jsx)("div",{className:"p-4 border rounded-xl bg-slate-50/50",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-black text-slate-800 uppercase",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 font-medium mt-1",children:["Inicio: ",e.start?new Date(e.start.seconds?1e3*e.start.seconds:e.start).toLocaleDateString():"-"]})]}),(0,a.jsx)("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-700 rounded-lg text-[10px] font-black uppercase",children:e.status})]})},e.id))]}),"HISTORIAL"===U&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"flex-1 space-y-4 mb-4",children:null===(s=X.historial)||void 0===s?void 0:s.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-indigo-400 rounded-full mt-1.5 shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-xs text-slate-400 font-mono",children:[new Date(e.date).toLocaleString()," - ",(0,a.jsx)("b",{children:e.user})]}),(0,a.jsx)("p",{className:"text-sm font-medium",children:e.note})]})]},t))}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4 border-t",children:[(0,a.jsx)("input",{className:"flex-1 bg-slate-50 border rounded-xl px-4 text-xs font-bold outline-none",placeholder:"Nota...",value:ei,onChange:e=>eo(e.target.value),onKeyDown:e=>"Enter"===e.key&&handleAddHistory()}),(0,a.jsx)("button",{onClick:handleAddHistory,className:"p-3 bg-indigo-600 text-white rounded-xl",children:(0,a.jsx)(z,{size:16})})]})]})]})]})]})]}),eZ&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl p-0 overflow-hidden flex flex-col max-h-[90vh]",children:[(0,a.jsxs)("div",{className:"p-6 border-b flex justify-between items-start bg-slate-50",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-black text-slate-800 flex items-center gap-2",children:[(0,a.jsx)(N.Z,{className:"text-indigo-600"})," Detalle de Propuesta"]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-1 font-mono",children:["ID: ",eZ.id]})]}),(0,a.jsx)("button",{onClick:()=>eM(null),className:"p-2 hover:bg-slate-200 rounded-full transition-colors",children:(0,a.jsx)(Z.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"p-6 overflow-y-auto flex-1 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-indigo-50 border border-indigo-100 rounded-xl",children:[(0,a.jsx)("p",{className:"text-[10px] font-bold text-indigo-400 uppercase mb-1",children:"Configuraci\xf3n del Servicio"}),(0,a.jsx)("p",{className:"text-sm font-black text-indigo-900",children:(null===(l=eZ.params)||void 0===l?void 0:l.servicios)?"".concat(eZ.params.servicios.length," Servicios"):"".concat(null===(w=eZ.params)||void 0===w?void 0:w.puestos," Puestos")}),(0,a.jsxs)("p",{className:"text-xs text-indigo-700",children:["Duraci\xf3n: ",null===(O=eZ.params)||void 0===O?void 0:O.mesesContrato," Meses"]})]}),(0,a.jsxs)("div",{className:"p-4 bg-emerald-50 border border-emerald-100 rounded-xl text-right",children:[(0,a.jsx)("p",{className:"text-[10px] font-bold text-emerald-500 uppercase mb-1",children:"Valor Total Contrato"}),(0,a.jsx)("p",{className:"text-2xl font-black text-emerald-700",children:formatMoney((null===(R=eZ.results)||void 0===R?void 0:R.valorTotalContrato)||(null===(D=eZ.results)||void 0===D?void 0:D.precioVentaTotal))}),(0,a.jsx)("p",{className:"text-[10px] text-emerald-600 font-bold",children:"+ IVA"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-xs font-black uppercase text-slate-400 mb-3 border-b pb-1",children:"Recursos Humanos"}),(0,a.jsx)("div",{className:"space-y-2",children:null===(T=eZ.team)||void 0===T?void 0:T.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border rounded-lg bg-slate-50/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"bg-white border w-8 h-8 flex items-center justify-center rounded-full text-xs font-bold shadow-sm",children:[e.cantidad,"x"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-bold text-slate-800",children:e.categoria}),(0,a.jsxs)("p",{className:"text-[10px] text-slate-500",children:["B\xe1sico Ref: ",formatMoney(e.basico)]})]})]}),(0,a.jsx)("span",{className:"text-xs font-mono font-bold text-slate-600",children:formatMoney(e.basico*e.cantidad)})]},t))})]}),eZ.proyeccion&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-xs font-black uppercase text-slate-400 mb-3 border-b pb-1",children:"Resumen Proyecci\xf3n"}),(0,a.jsx)("div",{className:"max-h-40 overflow-y-auto border rounded text-xs",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{className:"bg-slate-50 font-bold sticky top-0",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-2",children:"Mes"}),(0,a.jsx)("th",{className:"p-2 text-right",children:"Valor Cuota"})]})}),(0,a.jsx)("tbody",{children:eZ.proyeccion.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"p-2 border-b",children:e.mes}),(0,a.jsx)("td",{className:"p-2 border-b text-right font-mono",children:formatMoney(e.venta)})]},t))})]})})]}),(0,a.jsxs)("div",{className:"bg-slate-900 text-slate-300 p-4 rounded-xl text-xs space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Costo Directo Operativo (Mes 1)"})," ",(0,a.jsx)("span",{className:"font-mono text-white",children:formatMoney(null===(P=eZ.results)||void 0===P?void 0:P.costoDirectoTotal)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{children:["Margen Aplicado (",null===(F=eZ.params)||void 0===F?void 0:F.margenDeseado,"%)"]})," ",(0,a.jsxs)("span",{className:"font-mono text-emerald-400",children:["+",formatMoney(((null===(L=eZ.results)||void 0===L?void 0:L.precioVentaTotal)||0)-((null===(_=eZ.results)||void 0===_?void 0:_.costoDirectoTotal)||0))]})]})]})]}),(0,a.jsxs)("div",{className:"p-6 border-t bg-slate-50 flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>eM(null),className:"px-4 py-2 text-slate-500 font-bold hover:bg-slate-200 rounded-lg text-xs",children:"Cerrar"}),(0,a.jsxs)("button",{onClick:()=>printQuote(eZ),className:"px-4 py-2 bg-indigo-600 text-white font-bold rounded-lg flex items-center gap-2 hover:bg-indigo-700 text-xs shadow-lg shadow-indigo-200",children:[(0,a.jsx)(M.Z,{size:16})," Imprimir PDF Oficial"]})]})]})})]})}}},function(e){e.O(0,[761,897,963,712,354,774,888,179],function(){return e(e.s=80985)}),_N_E=e.O()}]);